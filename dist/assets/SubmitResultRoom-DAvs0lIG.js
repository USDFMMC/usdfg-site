import{j as e}from"./ui-C_ecRgbg.js";import{r as t}from"./vendor-BoDUibaF.js";import{M as s,a as r,V as n,C as a}from"./VoiceChat-BROWTqsR.js";import{f as i,M as o,r as l,u as c,t as d,v as h,x as m,L as u,n as x,p,X as f}from"./index-96YR-4iH.js";
/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=i("camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),g=i("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),j=i("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),y=i("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);function v(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}function w(...e){return t.useCallback(function(...e){return t=>{let s=!1;const r=e.map(e=>{const r=v(e,t);return s||"function"!=typeof r||(s=!0),r});if(s)return()=>{for(let t=0;t<r.length;t++){const s=r[t];"function"==typeof s?s():v(e[t],null)}}}}(...e),e)}class N extends t.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=t.offsetParent,s=l(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=s-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function k({children:s,isPresent:r,anchorX:n,root:a}){const i=t.useId(),l=t.useRef(null),c=t.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:d}=t.useContext(o),h=w(l,s?.ref);return t.useInsertionEffect(()=>{const{width:e,height:t,top:s,left:o,right:h}=c.current;if(r||!l.current||!e||!t)return;const m="left"===n?`left: ${o}`:`right: ${h}`;l.current.dataset.motionPopId=i;const u=document.createElement("style");d&&(u.nonce=d);const x=a??document.head;return x.appendChild(u),u.sheet&&u.sheet.insertRule(`\n          [data-motion-pop-id="${i}"] {\n            position: absolute !important;\n            width: ${e}px !important;\n            height: ${t}px !important;\n            ${m}px !important;\n            top: ${s}px !important;\n          }\n        `),()=>{x.contains(u)&&x.removeChild(u)}},[r]),e.jsx(N,{isPresent:r,childRef:l,sizeRef:c,children:t.cloneElement(s,{ref:h})})}const C=({children:s,initial:r,isPresent:n,onExitComplete:a,custom:i,presenceAffectsLayout:o,mode:l,anchorX:h,root:m})=>{const u=c(E),x=t.useId();let p=!0,f=t.useMemo(()=>(p=!1,{id:x,initial:r,isPresent:n,custom:i,onExitComplete:e=>{u.set(e,!0);for(const t of u.values())if(!t)return;a&&a()},register:e=>(u.set(e,!1),()=>u.delete(e))}),[n,u,a]);return o&&p&&(f={...f}),t.useMemo(()=>{u.forEach((e,t)=>u.set(t,!1))},[n]),t.useEffect(()=>{!n&&!u.size&&a&&a()},[n]),"popLayout"===l&&(s=e.jsx(k,{isPresent:n,anchorX:h,root:m,children:s})),e.jsx(d.Provider,{value:f,children:s})};function E(){return new Map}const R=e=>e.key||"";function L(e){const s=[];return t.Children.forEach(e,e=>{t.isValidElement(e)&&s.push(e)}),s}const P=({children:s,custom:r,initial:n=!0,onExitComplete:a,presenceAffectsLayout:i=!0,mode:o="sync",propagate:l=!1,anchorX:d="left",root:x})=>{const[p,f]=h(l),b=t.useMemo(()=>L(s),[s]),g=l&&!p?[]:b.map(R),j=t.useRef(!0),y=t.useRef(b),v=c(()=>new Map),[w,N]=t.useState(b),[k,E]=t.useState(b);m(()=>{j.current=!1,y.current=b;for(let e=0;e<k.length;e++){const t=R(k[e]);g.includes(t)?v.delete(t):!0!==v.get(t)&&v.set(t,!1)}},[k,g.length,g.join("-")]);const P=[];if(b!==w){let e=[...b];for(let t=0;t<k.length;t++){const s=k[t],r=R(s);g.includes(r)||(e.splice(t,0,s),P.push(s))}return"wait"===o&&P.length&&(e=P),E(L(e)),N(b),null}const{forceRender:S}=t.useContext(u);return e.jsx(e.Fragment,{children:k.map(t=>{const s=R(t),c=!(l&&!p)&&(b===k||g.includes(s));return e.jsx(C,{isPresent:c,initial:!(j.current&&!n)&&void 0,custom:r,presenceAffectsLayout:i,mode:o,root:x,onExitComplete:c?void 0:()=>{if(!v.has(s))return;v.set(s,!0);let e=!0;v.forEach(t=>{t||(e=!1)}),e&&(S?.(),E(y.current),l&&f?.(),a&&a())},anchorX:d,children:t},s)})})},S=t.memo(({isOpen:i,onClose:o,challengeId:l,challengeTitle:c,currentWallet:d,onSubmit:h,isSubmitting:m=!1})=>{const[u,v]=t.useState(null),[w,N]=t.useState(!1),[k,C]=t.useState(null),[E,R]=t.useState(null),[L,S]=t.useState(!1),_=t.useRef(null),M=t.useCallback(e=>{const t=e.target.files?.[0];if(t){R(t);const e=new FileReader;e.onloadend=()=>{C(e.result)},e.readAsDataURL(t)}},[]),z=t.useCallback(()=>{C(null),R(null),_.current&&(_.current.value="")},[]),$=t.useCallback(async()=>{if(null!==u){N(!0);try{await h(u,E),o()}catch(e){console.error("‚ùå Error submitting result:",e),alert(e.message||"Failed to submit result. Please try again.")}finally{N(!1)}}},[u,E,h,o]);return t.useEffect(()=>{const e=e=>{"Escape"!==e.key||!i||w||m||(console.log("‚å®Ô∏è ESC pressed - closing modal"),o())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[i,w,m,o]),e.jsx(P,{children:i&&e.jsx(e.Fragment,{children:L?e.jsx(x.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"fixed bottom-20 left-4 z-40 md:bottom-24 md:left-6",children:e.jsxs("button",{onClick:()=>S(!1),className:"px-4 py-2 bg-gradient-to-r from-yellow-600 to-orange-500 text-white rounded-lg shadow-[0_0_15px_rgba(255,215,130,0.2)] hover:brightness-110 transition-all flex items-center gap-2",children:[e.jsx(s,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Submit Result"})]})}):e.jsxs(e.Fragment,{children:[e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/30 backdrop-blur-sm z-40",onClick:()=>S(!0)}),e.jsx(x.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"tween",duration:.3,ease:"easeOut"},className:"fixed bottom-0 left-0 right-0 z-50 flex justify-center pointer-events-none",onClick:e=>e.stopPropagation(),children:e.jsx("div",{className:"w-full max-w-2xl bg-gradient-to-br from-gray-900 via-amber-900/20 to-gray-900 border-t border-x border-amber-500/30 rounded-t-xl shadow-[0_0_40px_rgba(0,0,0,0.5)] max-h-[90vh] overflow-y-auto pointer-events-auto",children:e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-start sticky top-0 bg-gray-900/95 backdrop-blur-sm -mx-6 px-6 py-4 border-b border-gray-800 z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-lg",children:e.jsx(p,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Submit Result"}),e.jsx("p",{className:"text-sm text-gray-400 mt-0.5",children:c})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>S(!0),disabled:w||m,className:"text-gray-400 hover:text-white transition-colors disabled:opacity-50",title:"Minimize",children:e.jsx(r,{className:"w-5 h-5"})}),e.jsx("button",{onClick:o,disabled:w||m,className:"text-gray-400 hover:text-white transition-colors disabled:opacity-50",title:"Close",children:e.jsx(f,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"bg-gradient-to-r from-amber-500/10 to-amber-600/10 border border-amber-500/20 rounded-xl p-4 mb-4",children:e.jsx("p",{className:"text-xl font-semibold text-white text-center",children:"Did you win this match?"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:()=>v(!0),disabled:w||m,className:`\n                        relative overflow-hidden p-4 rounded-lg border transition-all duration-200\n                        disabled:opacity-50 disabled:cursor-not-allowed\n                        ${!0===u?"border-green-500 bg-gradient-to-br from-green-500/20 to-emerald-500/20 shadow-[0_0_15px_rgba(16,185,129,0.2)]":"border-gray-600 bg-gray-800/50 hover:border-green-500/50 hover:bg-green-500/10"}\n                      `,children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-2",children:"üèÜ"}),e.jsx("p",{className:"text-xl font-bold text-white",children:"YES"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"I won"})]}),!0===u&&e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]}),e.jsxs("button",{onClick:()=>v(!1),disabled:w||m,className:`\n                        relative overflow-hidden p-4 rounded-lg border transition-all duration-200\n                        disabled:opacity-50 disabled:cursor-not-allowed\n                        ${!1===u?"border-red-500 bg-gradient-to-br from-red-500/20 to-rose-500/20 shadow-[0_0_15px_rgba(239,68,68,0.2)]":"border-gray-600 bg-gray-800/50 hover:border-red-500/50 hover:bg-red-500/10"}\n                      `,children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-4xl mb-2",children:"üòî"}),e.jsx("p",{className:"text-xl font-bold text-white",children:"NO"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"I lost"})]}),!1===u&&e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]})]})]}),!0===u&&e.jsx(x.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:e.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx("p",{className:"text-sm font-semibold text-amber-300",children:"üì∏ Upload Proof (Optional but Recommended)"})}),k?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:k,alt:"Proof",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:z,className:"absolute top-2 right-2 p-2 bg-red-600 hover:bg-red-700 rounded-full text-white transition-all",children:e.jsx(f,{className:"w-4 h-4"})}),e.jsxs("div",{className:"absolute bottom-2 left-2 px-2 py-1 bg-green-600 rounded text-xs text-white flex items-center gap-1",children:[e.jsx(g,{className:"w-3 h-3"}),"Proof uploaded"]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{ref:_,type:"file",accept:"image/*",capture:"environment",onChange:M,className:"hidden"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>_.current?.click(),className:"flex items-center justify-center gap-2 p-3 bg-gradient-to-r from-amber-600 to-amber-700 hover:from-amber-700 hover:to-amber-800 text-white rounded-lg transition-all",children:[e.jsx(b,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Take Photo"})]}),e.jsxs("button",{type:"button",onClick:()=>{_.current&&(_.current.removeAttribute("capture"),_.current.click())},className:"flex items-center justify-center gap-2 p-3 bg-amber-700 hover:bg-amber-800 text-white rounded-lg transition-all",children:[e.jsx(y,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Upload"})]})]}),e.jsx("p",{className:"text-xs text-gray-400 text-center mt-2",children:"Screenshot of victory screen, final score, or match result"})]})]})}),l&&""!==l.trim()&&e.jsx(n,{challengeId:l,currentWallet:d}),l&&""!==l.trim()&&e.jsx(a,{challengeId:l,currentWallet:d}),e.jsx("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-blue-300 text-center",children:"‚è∞ Your opponent has 2 hours to submit their result"})}),e.jsx("div",{className:"space-y-3",children:e.jsx("button",{onClick:$,disabled:null===u||w||m,className:`\n                      w-full py-4 rounded-xl font-bold text-lg transition-all duration-200\n                      disabled:opacity-50 disabled:cursor-not-allowed\n                      ${null!==u?"bg-gradient-to-r from-amber-600 to-amber-700 hover:from-amber-700 hover:to-amber-800 text-white shadow-[0_0_15px_rgba(255,215,130,0.2)]":"bg-gray-700 text-gray-400 cursor-not-allowed"}\n                    `,children:w||m?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):"Submit Result"})}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"‚ö†Ô∏è Results are final and cannot be changed after submission"})]})})})]})})})});export{S as SubmitResultRoom};

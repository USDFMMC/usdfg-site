import{i as t,r as e,S as n,b as r,P as o,a as i,c as s,T as a,d as c,B as u,e as l,f as d,g as h,K as f,h as p,U as _,u as y,j as m}from"./index-Bu1l0n_d.js";import{g,d as w}from"./vendor-CRqfoG-d.js";import"./ui-BOBdPEKy.js";var R,E={exports:{}};const A=g(function(){if(R)return E.exports;R=1;const t=/[\p{Lu}]/u,e=/[\p{Ll}]/u,n=/^[\p{Lu}](?![\p{Lu}])/gu,r=/([\p{Alpha}\p{N}_]|$)/u,o=/[_.\- ]+/,i=new RegExp("^"+o.source),s=new RegExp(o.source+r.source,"gu"),a=new RegExp("\\d+"+r.source,"gu"),c=(r,o)=>{if("string"!=typeof r&&!Array.isArray(r))throw new TypeError("Expected the input to be `string | string[]`");if(o={pascalCase:!1,preserveConsecutiveUppercase:!1,...o},0===(r=Array.isArray(r)?r.map(t=>t.trim()).filter(t=>t.length).join("-"):r.trim()).length)return"";const c=!1===o.locale?t=>t.toLowerCase():t=>t.toLocaleLowerCase(o.locale),u=!1===o.locale?t=>t.toUpperCase():t=>t.toLocaleUpperCase(o.locale);if(1===r.length)return o.pascalCase?u(r):c(r);return r!==c(r)&&(r=((n,r,o)=>{let i=!1,s=!1,a=!1;for(let c=0;c<n.length;c++){const u=n[c];i&&t.test(u)?(n=n.slice(0,c)+"-"+n.slice(c),i=!1,a=s,s=!0,c++):s&&a&&e.test(u)?(n=n.slice(0,c-1)+"-"+n.slice(c-1),a=s,s=!1,i=!0):(i=r(u)===u&&o(u)!==u,a=s,s=o(u)===u&&r(u)!==u)}return n})(r,c,u)),r=r.replace(i,""),r=o.preserveConsecutiveUppercase?((t,e)=>(n.lastIndex=0,t.replace(n,t=>e(t))))(r,c):c(r),o.pascalCase&&(r=u(r.charAt(0))+r.slice(1)),((t,e)=>(s.lastIndex=0,a.lastIndex=0,t.replace(s,(t,n)=>e(n)).replace(a,t=>e(t))))(r,u)};return E.exports=c,E.exports.default=c,E.exports}());var v,O={},T={};function N(){if(v)return T;v=1;class t{constructor(t,e){if(!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=e}makeDestinationObject(){return{}}decode(t,e){throw new Error("Layout is abstract")}encode(t,e,n){throw new Error("Layout is abstract")}getSpan(t,e){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(t){const e=Object.create(this.constructor.prototype);return Object.assign(e,this),e.property=t,e}fromArray(t){}}function e(t,e){return e.property?t+"["+e.property+"]":t}T.Layout=t,T.nameWithProperty=e,T.bindConstructorLayout=function(e,n){if("function"!=typeof e)throw new TypeError("Class must be constructor");if(e.hasOwnProperty("layout_"))throw new Error("Class is already bound to a layout");if(!(n&&n instanceof t))throw new TypeError("layout must be a Layout");if(n.hasOwnProperty("boundConstructor_"))throw new Error("layout is already bound to a constructor");e.layout_=n,n.boundConstructor_=e,n.makeDestinationObject=()=>new e,Object.defineProperty(e.prototype,"encode",{value:function(t,e){return n.encode(this,t,e)},writable:!0}),Object.defineProperty(e,"decode",{value:function(t,e){return n.decode(t,e)},writable:!0})};class n extends t{isCount(){throw new Error("ExternalLayout is abstract")}}class r extends n{constructor(t,e){if(void 0===t&&(t=1),!Number.isInteger(t)||0>=t)throw new TypeError("elementSpan must be a (positive) integer");super(-1,e),this.elementSpan=t}isCount(){return!0}decode(t,e){void 0===e&&(e=0);const n=t.length-e;return Math.floor(n/this.elementSpan)}encode(t,e,n){return 0}}class o extends n{constructor(e,n,r){if(!(e instanceof t))throw new TypeError("layout must be a Layout");if(void 0===n)n=0;else if(!Number.isInteger(n))throw new TypeError("offset must be integer or undefined");super(e.span,r||e.property),this.layout=e,this.offset=n}isCount(){return this.layout instanceof i||this.layout instanceof s}decode(t,e){return void 0===e&&(e=0),this.layout.decode(t,e+this.offset)}encode(t,e,n){return void 0===n&&(n=0),this.layout.encode(t,e,n+this.offset)}}class i extends t{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e){return void 0===e&&(e=0),t.readUIntLE(e,this.span)}encode(t,e,n){return void 0===n&&(n=0),e.writeUIntLE(t,n,this.span),this.span}}class s extends t{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e){return void 0===e&&(e=0),t.readUIntBE(e,this.span)}encode(t,e,n){return void 0===n&&(n=0),e.writeUIntBE(t,n,this.span),this.span}}class a extends t{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e){return void 0===e&&(e=0),t.readIntLE(e,this.span)}encode(t,e,n){return void 0===n&&(n=0),e.writeIntLE(t,n,this.span),this.span}}class c extends t{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e){return void 0===e&&(e=0),t.readIntBE(e,this.span)}encode(t,e,n){return void 0===n&&(n=0),e.writeIntBE(t,n,this.span),this.span}}const u=Math.pow(2,32);function l(t){const e=Math.floor(t/u);return{hi32:e,lo32:t-e*u}}function d(t,e){return t*u+e}class h extends t{constructor(t){super(8,t)}decode(t,e){void 0===e&&(e=0);const n=t.readUInt32LE(e);return d(t.readUInt32LE(e+4),n)}encode(t,e,n){void 0===n&&(n=0);const r=l(t);return e.writeUInt32LE(r.lo32,n),e.writeUInt32LE(r.hi32,n+4),8}}class f extends t{constructor(t){super(8,t)}decode(t,e){void 0===e&&(e=0);return d(t.readUInt32BE(e),t.readUInt32BE(e+4))}encode(t,e,n){void 0===n&&(n=0);const r=l(t);return e.writeUInt32BE(r.hi32,n),e.writeUInt32BE(r.lo32,n+4),8}}class p extends t{constructor(t){super(8,t)}decode(t,e){void 0===e&&(e=0);const n=t.readUInt32LE(e);return d(t.readInt32LE(e+4),n)}encode(t,e,n){void 0===n&&(n=0);const r=l(t);return e.writeUInt32LE(r.lo32,n),e.writeInt32LE(r.hi32,n+4),8}}class _ extends t{constructor(t){super(8,t)}decode(t,e){void 0===e&&(e=0);return d(t.readInt32BE(e),t.readUInt32BE(e+4))}encode(t,e,n){void 0===n&&(n=0);const r=l(t);return e.writeInt32BE(r.hi32,n),e.writeUInt32BE(r.lo32,n+4),8}}class y extends t{constructor(t){super(4,t)}decode(t,e){return void 0===e&&(e=0),t.readFloatLE(e)}encode(t,e,n){return void 0===n&&(n=0),e.writeFloatLE(t,n),4}}class m extends t{constructor(t){super(4,t)}decode(t,e){return void 0===e&&(e=0),t.readFloatBE(e)}encode(t,e,n){return void 0===n&&(n=0),e.writeFloatBE(t,n),4}}class g extends t{constructor(t){super(8,t)}decode(t,e){return void 0===e&&(e=0),t.readDoubleLE(e)}encode(t,e,n){return void 0===n&&(n=0),e.writeDoubleLE(t,n),8}}class w extends t{constructor(t){super(8,t)}decode(t,e){return void 0===e&&(e=0),t.readDoubleBE(e)}encode(t,e,n){return void 0===n&&(n=0),e.writeDoubleBE(t,n),8}}class R extends t{constructor(e,r,o){if(!(e instanceof t))throw new TypeError("elementLayout must be a Layout");if(!(r instanceof n&&r.isCount()||Number.isInteger(r)&&0<=r))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let i=-1;!(r instanceof n)&&0<e.span&&(i=r*e.span),super(i,o),this.elementLayout=e,this.count=r}getSpan(t,e){if(0<=this.span)return this.span;void 0===e&&(e=0);let r=0,o=this.count;if(o instanceof n&&(o=o.decode(t,e)),0<this.elementLayout.span)r=o*this.elementLayout.span;else{let n=0;for(;n<o;)r+=this.elementLayout.getSpan(t,e+r),++n}return r}decode(t,e){void 0===e&&(e=0);const r=[];let o=0,i=this.count;for(i instanceof n&&(i=i.decode(t,e));o<i;)r.push(this.elementLayout.decode(t,e)),e+=this.elementLayout.getSpan(t,e),o+=1;return r}encode(t,e,r){void 0===r&&(r=0);const o=this.elementLayout,i=t.reduce((t,n)=>t+o.encode(n,e,r+t),0);return this.count instanceof n&&this.count.encode(t.length,e,r),i}}class E extends t{constructor(e,n,r){if(!Array.isArray(e)||!e.reduce((e,n)=>e&&n instanceof t,!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof n&&void 0===r&&(r=n,n=void 0);for(const t of e)if(0>t.span&&void 0===t.property)throw new Error("fields cannot contain unnamed variable-length layout");let o=-1;try{o=e.reduce((t,e)=>t+e.getSpan(),0)}catch(i){}super(o,n),this.fields=e,this.decodePrefixes=!!r}getSpan(t,e){if(0<=this.span)return this.span;void 0===e&&(e=0);let n=0;try{n=this.fields.reduce((n,r)=>{const o=r.getSpan(t,e);return e+=o,n+o},0)}catch(r){throw new RangeError("indeterminate span")}return n}decode(t,e){void 0===e&&(e=0);const n=this.makeDestinationObject();for(const r of this.fields)if(void 0!==r.property&&(n[r.property]=r.decode(t,e)),e+=r.getSpan(t,e),this.decodePrefixes&&t.length===e)break;return n}encode(t,e,n){void 0===n&&(n=0);const r=n;let o=0,i=0;for(const s of this.fields){let r=s.span;if(i=0<r?r:0,void 0!==s.property){const o=t[s.property];void 0!==o&&(i=s.encode(o,e,n),0>r&&(r=s.getSpan(e,n)))}o=n,n+=r}return o+i-r}fromArray(t){const e=this.makeDestinationObject();for(const n of this.fields)void 0!==n.property&&0<t.length&&(e[n.property]=t.shift());return e}layoutFor(t){if("string"!=typeof t)throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}offsetOf(t){if("string"!=typeof t)throw new TypeError("property must be string");let e=0;for(const n of this.fields){if(n.property===t)return e;0>n.span?e=-1:0<=e&&(e+=n.span)}}}class A{constructor(t){this.property=t}decode(){throw new Error("UnionDiscriminator is abstract")}encode(){throw new Error("UnionDiscriminator is abstract")}}class O extends A{constructor(t,e){if(!(t instanceof n&&t.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(e||t.property||"variant"),this.layout=t}decode(t,e){return this.layout.decode(t,e)}encode(t,e,n){return this.layout.encode(t,e,n)}}class N extends t{constructor(e,r,a){const c=e instanceof i||e instanceof s;if(c)e=new O(new o(e));else if(e instanceof n&&e.isCount())e=new O(e);else if(!(e instanceof A))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(void 0===r&&(r=null),!(null===r||r instanceof t))throw new TypeError("defaultLayout must be null or a Layout");if(null!==r){if(0>r.span)throw new Error("defaultLayout must have constant span");void 0===r.property&&(r=r.replicate("content"))}let u=-1;r&&(u=r.span,0<=u&&c&&(u+=e.layout.span)),super(u,a),this.discriminator=e,this.usesPrefixDiscriminator=c,this.defaultLayout=r,this.registry={};let l=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(t){return l(t)},this.configGetSourceVariant=function(t){l=t.bind(this)}}getSpan(t,e){if(0<=this.span)return this.span;void 0===e&&(e=0);const n=this.getVariant(t,e);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(t,e)}defaultGetSourceVariant(t){if(t.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&t.hasOwnProperty(this.defaultLayout.property))return;const e=this.registry[t[this.discriminator.property]];if(e&&(!e.layout||t.hasOwnProperty(e.property)))return e}else for(const e in this.registry){const n=this.registry[e];if(t.hasOwnProperty(n.property))return n}throw new Error("unable to infer src variant")}decode(t,e){let n;void 0===e&&(e=0);const r=this.discriminator,o=r.decode(t,e);let i=this.registry[o];if(void 0===i){let s=0;i=this.defaultLayout,this.usesPrefixDiscriminator&&(s=r.layout.span),n=this.makeDestinationObject(),n[r.property]=o,n[i.property]=this.defaultLayout.decode(t,e+s)}else n=i.decode(t,e);return n}encode(t,e,n){void 0===n&&(n=0);const r=this.getSourceVariant(t);if(void 0===r){const r=this.discriminator,o=this.defaultLayout;let i=0;return this.usesPrefixDiscriminator&&(i=r.layout.span),r.encode(t[r.property],e,n),i+o.encode(t[o.property],e,n+i)}return r.encode(t,e,n)}addVariant(t,e,n){const r=new b(this,t,e,n);return this.registry[t]=r,r}getVariant(t,e){let n=t;return Buffer.isBuffer(t)&&(void 0===e&&(e=0),n=this.discriminator.decode(t,e)),this.registry[n]}}class b extends t{constructor(e,n,r,o){if(!(e instanceof N))throw new TypeError("union must be a Union");if(!Number.isInteger(n)||0>n)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof r&&void 0===o&&(o=r,r=null),r){if(!(r instanceof t))throw new TypeError("layout must be a Layout");if(null!==e.defaultLayout&&0<=r.span&&r.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof o)throw new TypeError("variant must have a String property")}let i=e.span;0>e.span&&(i=r?r.span:0,0<=i&&e.usesPrefixDiscriminator&&(i+=e.discriminator.layout.span)),super(i,o),this.union=e,this.variant=n,this.layout=r||null}getSpan(t,e){if(0<=this.span)return this.span;void 0===e&&(e=0);let n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),n+this.layout.getSpan(t,e+n)}decode(t,e){const n=this.makeDestinationObject();if(void 0===e&&(e=0),this!==this.union.getVariant(t,e))throw new Error("variant mismatch");let r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(t,e+r):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(t,e,n){void 0===n&&(n=0);let r=0;if(this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout&&!t.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,e,n);let o=r;if(this.layout&&(this.layout.encode(t[this.property],e,n+r),o+=this.layout.getSpan(e,n+r),0<=this.union.span&&o>this.union.span))throw new Error("encoded variant overruns containing union");return o}fromArray(t){if(this.layout)return this.layout.fromArray(t)}}function I(t){return 0>t&&(t+=4294967296),t}class C extends t{constructor(t,e,n){if(!(t instanceof i||t instanceof s))throw new TypeError("word must be a UInt or UIntBE layout");if("string"==typeof e&&void 0===n&&(n=e,e=void 0),4<t.span)throw new RangeError("word cannot exceed 32 bits");super(t.span,n),this.word=t,this.msb=!!e,this.fields=[];let r=0;this._packedSetValue=function(t){return r=I(t),this},this._packedGetValue=function(){return r}}decode(t,e){const n=this.makeDestinationObject();void 0===e&&(e=0);const r=this.word.decode(t,e);this._packedSetValue(r);for(const o of this.fields)void 0!==o.property&&(n[o.property]=o.decode(r));return n}encode(t,e,n){void 0===n&&(n=0);const r=this.word.decode(e,n);this._packedSetValue(r);for(const o of this.fields)if(void 0!==o.property){const e=t[o.property];void 0!==e&&o.encode(e)}return this.word.encode(this._packedGetValue(),e,n)}addField(t,e){const n=new S(this,t,e);return this.fields.push(n),n}addBoolean(t){const e=new x(this,t);return this.fields.push(e),e}fieldFor(t){if("string"!=typeof t)throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}}class S{constructor(t,e,n){if(!(t instanceof C))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(e)||0>=e)throw new TypeError("bits must be positive integer");const r=8*t.span,o=t.fields.reduce((t,e)=>t+e.bits,0);if(e+o>r)throw new Error("bits too long for span remainder ("+(r-o)+" of "+r+" remain)");this.container=t,this.bits=e,this.valueMask=(1<<e)-1,32===e&&(this.valueMask=4294967295),this.start=o,this.container.msb&&(this.start=r-o-e),this.wordMask=I(this.valueMask<<this.start),this.property=n}decode(){return I(this.container._packedGetValue()&this.wordMask)>>>this.start}encode(t){if(!Number.isInteger(t)||t!==I(t&this.valueMask))throw new TypeError(e("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const n=this.container._packedGetValue(),r=I(t<<this.start);this.container._packedSetValue(I(n&~this.wordMask)|r)}}class x extends S{constructor(t,e){super(t,1,e)}decode(t,e){return!!S.prototype.decode.call(this,t,e)}encode(t){return"boolean"==typeof t&&(t=+t),S.prototype.encode.call(this,t)}}class k extends t{constructor(t,e){if(!(t instanceof n&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let r=-1;t instanceof n||(r=t),super(r,e),this.length=t}getSpan(t,e){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),n}decode(t,e){void 0===e&&(e=0);let n=this.span;return 0>n&&(n=this.length.decode(t,e)),t.slice(e,e+n)}encode(t,r,o){let i=this.length;if(this.length instanceof n&&(i=t.length),!Buffer.isBuffer(t)||i!==t.length)throw new TypeError(e("Blob.encode",this)+" requires (length "+i+") Buffer as src");if(o+i>r.length)throw new RangeError("encoding overruns Buffer");return r.write(t.toString("hex"),o,i,"hex"),this.length instanceof n&&this.length.encode(i,r,o),i}}class D extends t{constructor(t){super(-1,t)}getSpan(t,e){if(!Buffer.isBuffer(t))throw new TypeError("b must be a Buffer");void 0===e&&(e=0);let n=e;for(;n<t.length&&0!==t[n];)n+=1;return 1+n-e}decode(t,e,n){void 0===e&&(e=0);let r=this.getSpan(t,e);return t.slice(e,e+r-1).toString("utf-8")}encode(t,e,n){void 0===n&&(n=0),"string"!=typeof t&&(t=t.toString());const r=new Buffer(t,"utf8"),o=r.length;if(n+o>e.length)throw new RangeError("encoding overruns Buffer");return r.copy(e,n),e[n+o]=0,o+1}}class M extends t{constructor(t,e){if("string"==typeof t&&void 0===e&&(e=t,t=void 0),void 0===t)t=-1;else if(!Number.isInteger(t))throw new TypeError("maxSpan must be an integer");super(-1,e),this.maxSpan=t}getSpan(t,e){if(!Buffer.isBuffer(t))throw new TypeError("b must be a Buffer");return void 0===e&&(e=0),t.length-e}decode(t,e,n){void 0===e&&(e=0);let r=this.getSpan(t,e);if(0<=this.maxSpan&&this.maxSpan<r)throw new RangeError("text length exceeds maxSpan");return t.slice(e,e+r).toString("utf-8")}encode(t,e,n){void 0===n&&(n=0),"string"!=typeof t&&(t=t.toString());const r=new Buffer(t,"utf8"),o=r.length;if(0<=this.maxSpan&&this.maxSpan<o)throw new RangeError("text length exceeds maxSpan");if(n+o>e.length)throw new RangeError("encoding overruns Buffer");return r.copy(e,n),o}}class P extends t{constructor(t,e){super(0,e),this.value=t}decode(t,e,n){return this.value}encode(t,e,n){return 0}}return T.ExternalLayout=n,T.GreedyCount=r,T.OffsetLayout=o,T.UInt=i,T.UIntBE=s,T.Int=a,T.IntBE=c,T.Float=y,T.FloatBE=m,T.Double=g,T.DoubleBE=w,T.Sequence=R,T.Structure=E,T.UnionDiscriminator=A,T.UnionLayoutDiscriminator=O,T.Union=N,T.VariantLayout=b,T.BitStructure=C,T.BitField=S,T.Boolean=x,T.Blob=k,T.CString=D,T.UTF8=M,T.Constant=P,T.greedy=(t,e)=>new r(t,e),T.offset=(t,e,n)=>new o(t,e,n),T.u8=t=>new i(1,t),T.u16=t=>new i(2,t),T.u24=t=>new i(3,t),T.u32=t=>new i(4,t),T.u40=t=>new i(5,t),T.u48=t=>new i(6,t),T.nu64=t=>new h(t),T.u16be=t=>new s(2,t),T.u24be=t=>new s(3,t),T.u32be=t=>new s(4,t),T.u40be=t=>new s(5,t),T.u48be=t=>new s(6,t),T.nu64be=t=>new f(t),T.s8=t=>new a(1,t),T.s16=t=>new a(2,t),T.s24=t=>new a(3,t),T.s32=t=>new a(4,t),T.s40=t=>new a(5,t),T.s48=t=>new a(6,t),T.ns64=t=>new p(t),T.s16be=t=>new c(2,t),T.s24be=t=>new c(3,t),T.s32be=t=>new c(4,t),T.s40be=t=>new c(5,t),T.s48be=t=>new c(6,t),T.ns64be=t=>new _(t),T.f32=t=>new y(t),T.f32be=t=>new m(t),T.f64=t=>new g(t),T.f64be=t=>new w(t),T.struct=(t,e,n)=>new E(t,e,n),T.bits=(t,e,n)=>new C(t,e,n),T.seq=(t,e,n)=>new R(t,e,n),T.union=(t,e,n)=>new N(t,e,n),T.unionLayoutDiscriminator=(t,e)=>new O(t,e),T.blob=(t,e)=>new k(t,e),T.cstr=t=>new D(t),T.utf8=(t,e)=>new M(t,e),T.const=(t,e)=>new P(t,e),T}const b=w(t);var I;var C=(I||(I=1,function(t){var n=O&&O.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(t,"__esModule",{value:!0}),t.struct=t.f64=t.f32=t.i32=t.u32=t.i16=t.u16=t.i8=t.u8=void 0,t.u64=c,t.i64=function(t){return new a(8,!0,t)},t.u128=function(t){return new a(16,!1,t)},t.i128=function(t){return new a(16,!0,t)},t.u256=function(t){return new a(32,!1,t)},t.i256=function(t){return new a(32,!0,t)},t.publicKey=function(t){return new u((0,r.blob)(32),t=>new o.PublicKey(t),t=>t.toBuffer(),t)},t.option=function(t,e){return new l(t,e)},t.bool=function(t){return new u((0,r.u8)(),d,h,t)},t.vec=function(t,e){const n=(0,r.u32)("length"),o=(0,r.struct)([n,(0,r.seq)(t,(0,r.offset)(n,-n.span),"values")]);return new u(o,({values:t})=>t,t=>({values:t}),e)},t.tagged=function(t,e,n){const o=(0,r.struct)([c("tag"),e.replicate("data")]);return new u(o,function({tag:e,data:n}){if(!e.eq(t))throw new Error("Invalid tag, expected: "+t.toString("hex")+", got: "+e.toString("hex"));return n},e=>({tag:t,data:e}),n)},t.vecU8=f,t.str=function(t){return new u(f(),t=>t.toString("utf-8"),t=>Buffer.from(t,"utf-8"),t)},t.rustEnum=function(t,e,n){const o=(0,r.union)(null!=n?n:(0,r.u8)(),e);return t.forEach((t,e)=>o.addVariant(e,t,t.property)),o},t.array=function(t,e,n){const o=(0,r.struct)([(0,r.seq)(t,e,"values")]);return new u(o,({values:t})=>t,t=>({values:t}),n)},t.map=function(t,e,n){const o=(0,r.u32)("length"),i=(0,r.struct)([o,(0,r.seq)(new p(t,e),(0,r.offset)(o,-o.span),"values")]);return new u(i,({values:t})=>new Map(t),t=>({values:Array.from(t.entries())}),n)};const r=N(),o=b,i=n(e());var s=N();Object.defineProperty(t,"u8",{enumerable:!0,get:function(){return s.u8}}),Object.defineProperty(t,"i8",{enumerable:!0,get:function(){return s.s8}}),Object.defineProperty(t,"u16",{enumerable:!0,get:function(){return s.u16}}),Object.defineProperty(t,"i16",{enumerable:!0,get:function(){return s.s16}}),Object.defineProperty(t,"u32",{enumerable:!0,get:function(){return s.u32}}),Object.defineProperty(t,"i32",{enumerable:!0,get:function(){return s.s32}}),Object.defineProperty(t,"f32",{enumerable:!0,get:function(){return s.f32}}),Object.defineProperty(t,"f64",{enumerable:!0,get:function(){return s.f64}}),Object.defineProperty(t,"struct",{enumerable:!0,get:function(){return s.struct}});class a extends r.Layout{constructor(t,e,n){super(t,n),this.blob=(0,r.blob)(t),this.signed=e}decode(t,e=0){const n=new i.default(this.blob.decode(t,e),10,"le");return this.signed?n.fromTwos(8*this.span).clone():n}encode(t,e,n=0){return this.signed&&(t=t.toTwos(8*this.span)),this.blob.encode(t.toArrayLike(Buffer,"le",this.span),e,n)}}function c(t){return new a(8,!1,t)}class u extends r.Layout{constructor(t,e,n,r){super(t.span,r),this.layout=t,this.decoder=e,this.encoder=n}decode(t,e){return this.decoder(this.layout.decode(t,e))}encode(t,e,n){return this.layout.encode(this.encoder(t),e,n)}getSpan(t,e){return this.layout.getSpan(t,e)}}class l extends r.Layout{constructor(t,e){super(-1,e),this.layout=t,this.discriminator=(0,r.u8)()}encode(t,e,n=0){return null==t?this.discriminator.encode(0,e,n):(this.discriminator.encode(1,e,n),this.layout.encode(t,e,n+1)+1)}decode(t,e=0){const n=this.discriminator.decode(t,e);if(0===n)return null;if(1===n)return this.layout.decode(t,e+1);throw new Error("Invalid option "+this.property)}getSpan(t,e=0){const n=this.discriminator.decode(t,e);if(0===n)return 1;if(1===n)return this.layout.getSpan(t,e+1)+1;throw new Error("Invalid option "+this.property)}}function d(t){if(0===t)return!1;if(1===t)return!0;throw new Error("Invalid bool: "+t)}function h(t){return t?1:0}function f(t){const e=(0,r.u32)("length"),n=(0,r.struct)([e,(0,r.blob)((0,r.offset)(e,-e.span),"data")]);return new u(n,({data:t})=>t,t=>({data:t}),t)}class p extends r.Layout{constructor(t,e,n){super(t.span+e.span,n),this.keyLayout=t,this.valueLayout=e}decode(t,e){return e=e||0,[this.keyLayout.decode(t,e),this.valueLayout.decode(t,e+this.keyLayout.getSpan(t,e))]}encode(t,e,n){n=n||0;const r=this.keyLayout.encode(t[0],e,n);return r+this.valueLayout.encode(t[1],e,n+r)}getSpan(t,e){return this.keyLayout.getSpan(t,e)+this.valueLayout.getSpan(t,e)}}}(O)),O);
/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */function S(t){let e=t.length;for(;--e>=0;)t[e]=0}S(new Array(576));S(new Array(60));S(new Array(512));S(new Array(256));S(new Array(29));S(new Array(30));var x=(t,e,n,r)=>{let o=65535&t,i=t>>>16&65535,s=0;for(;0!==n;){s=n>2e3?2e3:n,n-=s;do{o=o+e[r++]|0,i=i+o|0}while(--s);o%=65521,i%=65521}return o|i<<16};const k=new Uint32Array((()=>{let t,e=[];for(var n=0;n<256;n++){t=n;for(var r=0;r<8;r++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e})());var D=(t,e,n,r)=>{const o=k,i=r+n;t^=-1;for(let s=r;s<i;s++)t=t>>>8^o[255&(t^e[s])];return-1^t},M={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},P={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const L=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var U=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const e in n)L(n,e)&&(t[e]=n[e])}}return t},H=t=>{let e=0;for(let r=0,o=t.length;r<o;r++)e+=t[r].length;const n=new Uint8Array(e);for(let r=0,o=0,i=t.length;r<i;r++){let e=t[r];n.set(e,o),o+=e.length}return n};let B=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Lo){B=!1}const G=new Uint8Array(256);for(let Uo=0;Uo<256;Uo++)G[Uo]=Uo>=252?6:Uo>=248?5:Uo>=240?4:Uo>=224?3:Uo>=192?2:1;G[254]=G[254]=1;var V=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,n,r,o,i,s=t.length,a=0;for(o=0;o<s;o++)n=t.charCodeAt(o),55296==(64512&n)&&o+1<s&&(r=t.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(e=new Uint8Array(a),i=0,o=0;i<a;o++)n=t.charCodeAt(o),55296==(64512&n)&&o+1<s&&(r=t.charCodeAt(o+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),o++)),n<128?e[i++]=n:n<2048?(e[i++]=192|n>>>6,e[i++]=128|63&n):n<65536?(e[i++]=224|n>>>12,e[i++]=128|n>>>6&63,e[i++]=128|63&n):(e[i++]=240|n>>>18,e[i++]=128|n>>>12&63,e[i++]=128|n>>>6&63,e[i++]=128|63&n);return e},j=(t,e)=>{const n=e||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let r,o;const i=new Array(2*n);for(o=0,r=0;r<n;){let e=t[r++];if(e<128){i[o++]=e;continue}let s=G[e];if(s>4)i[o++]=65533,r+=s-1;else{for(e&=2===s?31:3===s?15:7;s>1&&r<n;)e=e<<6|63&t[r++],s--;s>1?i[o++]=65533:e<65536?i[o++]=e:(e-=65536,i[o++]=55296|e>>10&1023,i[o++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&B)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n})(i,o)},z=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let n=e-1;for(;n>=0&&128==(192&t[n]);)n--;return n<0||0===n?e:n+G[t[n]]>e?n:e};var K=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const F=16209;var $=function(t,e){let n,r,o,i,s,a,c,u,l,d,h,f,p,_,y,m,g,w,R,E,A,v,O,T;const N=t.state;n=t.next_in,O=t.input,r=n+(t.avail_in-5),o=t.next_out,T=t.output,i=o-(e-t.avail_out),s=o+(t.avail_out-257),a=N.dmax,c=N.wsize,u=N.whave,l=N.wnext,d=N.window,h=N.hold,f=N.bits,p=N.lencode,_=N.distcode,y=(1<<N.lenbits)-1,m=(1<<N.distbits)-1;t:do{f<15&&(h+=O[n++]<<f,f+=8,h+=O[n++]<<f,f+=8),g=p[h&y];e:for(;;){if(w=g>>>24,h>>>=w,f-=w,w=g>>>16&255,0===w)T[o++]=65535&g;else{if(!(16&w)){if(64&w){if(32&w){N.mode=16191;break t}t.msg="invalid literal/length code",N.mode=F;break t}g=p[(65535&g)+(h&(1<<w)-1)];continue e}for(R=65535&g,w&=15,w&&(f<w&&(h+=O[n++]<<f,f+=8),R+=h&(1<<w)-1,h>>>=w,f-=w),f<15&&(h+=O[n++]<<f,f+=8,h+=O[n++]<<f,f+=8),g=_[h&m];;){if(w=g>>>24,h>>>=w,f-=w,w=g>>>16&255,16&w){if(E=65535&g,w&=15,f<w&&(h+=O[n++]<<f,f+=8,f<w&&(h+=O[n++]<<f,f+=8)),E+=h&(1<<w)-1,E>a){t.msg="invalid distance too far back",N.mode=F;break t}if(h>>>=w,f-=w,w=o-i,E>w){if(w=E-w,w>u&&N.sane){t.msg="invalid distance too far back",N.mode=F;break t}if(A=0,v=d,0===l){if(A+=c-w,w<R){R-=w;do{T[o++]=d[A++]}while(--w);A=o-E,v=T}}else if(l<w){if(A+=c+l-w,w-=l,w<R){R-=w;do{T[o++]=d[A++]}while(--w);if(A=0,l<R){w=l,R-=w;do{T[o++]=d[A++]}while(--w);A=o-E,v=T}}}else if(A+=l-w,w<R){R-=w;do{T[o++]=d[A++]}while(--w);A=o-E,v=T}for(;R>2;)T[o++]=v[A++],T[o++]=v[A++],T[o++]=v[A++],R-=3;R&&(T[o++]=v[A++],R>1&&(T[o++]=v[A++]))}else{A=o-E;do{T[o++]=T[A++],T[o++]=T[A++],T[o++]=T[A++],R-=3}while(R>2);R&&(T[o++]=T[A++],R>1&&(T[o++]=T[A++]))}break}if(64&w){t.msg="invalid distance code",N.mode=F;break t}g=_[(65535&g)+(h&(1<<w)-1)]}}break}}while(n<r&&o<s);R=f>>3,n-=R,f-=R<<3,h&=(1<<f)-1,t.next_in=n,t.next_out=o,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=o<s?s-o+257:257-(o-s),N.hold=h,N.bits=f};const q=15,Z=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),W=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),X=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Y=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Q=(t,e,n,r,o,i,s,a)=>{const c=a.bits;let u,l,d,h,f,p,_=0,y=0,m=0,g=0,w=0,R=0,E=0,A=0,v=0,O=0,T=null;const N=new Uint16Array(16),b=new Uint16Array(16);let I,C,S,x=null;for(_=0;_<=q;_++)N[_]=0;for(y=0;y<r;y++)N[e[n+y]]++;for(w=c,g=q;g>=1&&0===N[g];g--);if(w>g&&(w=g),0===g)return o[i++]=20971520,o[i++]=20971520,a.bits=1,0;for(m=1;m<g&&0===N[m];m++);for(w<m&&(w=m),A=1,_=1;_<=q;_++)if(A<<=1,A-=N[_],A<0)return-1;if(A>0&&(0===t||1!==g))return-1;for(b[1]=0,_=1;_<q;_++)b[_+1]=b[_]+N[_];for(y=0;y<r;y++)0!==e[n+y]&&(s[b[e[n+y]]++]=y);if(0===t?(T=x=s,p=20):1===t?(T=Z,x=W,p=257):(T=X,x=Y,p=0),O=0,y=0,_=m,f=i,R=w,E=0,d=-1,v=1<<w,h=v-1,1===t&&v>852||2===t&&v>592)return 1;for(;;){I=_-E,s[y]+1<p?(C=0,S=s[y]):s[y]>=p?(C=x[s[y]-p],S=T[s[y]-p]):(C=96,S=0),u=1<<_-E,l=1<<R,m=l;do{l-=u,o[f+(O>>E)+l]=I<<24|C<<16|S}while(0!==l);for(u=1<<_-1;O&u;)u>>=1;if(0!==u?(O&=u-1,O+=u):O=0,y++,0===--N[_]){if(_===g)break;_=e[n+s[y]]}if(_>w&&(O&h)!==d){for(0===E&&(E=w),f+=m,R=_-E,A=1<<R;R+E<g&&(A-=N[R+E],!(A<=0));)R++,A<<=1;if(v+=1<<R,1===t&&v>852||2===t&&v>592)return 1;d=O&h,o[d]=w<<24|R<<16|f-i}}return 0!==O&&(o[f+O]=_-E<<24|64<<16),a.bits=w,0};const{Z_FINISH:J,Z_BLOCK:tt,Z_TREES:et,Z_OK:nt,Z_STREAM_END:rt,Z_NEED_DICT:ot,Z_STREAM_ERROR:it,Z_DATA_ERROR:st,Z_MEM_ERROR:at,Z_BUF_ERROR:ct,Z_DEFLATED:ut}=P,lt=16180,dt=16190,ht=16191,ft=16192,pt=16194,_t=16199,yt=16200,mt=16206,gt=16209,wt=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Rt(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Et=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<lt||e.mode>16211?1:0},At=t=>{if(Et(t))return it;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=lt,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,nt},vt=t=>{if(Et(t))return it;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,At(t)},Ot=(t,e)=>{let n;if(Et(t))return it;const r=t.state;return e<0?(n=0,e=-e):(n=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?it:(null!==r.window&&r.wbits!==e&&(r.window=null),r.wrap=n,r.wbits=e,vt(t))},Tt=(t,e)=>{if(!t)return it;const n=new Rt;t.state=n,n.strm=t,n.window=null,n.mode=lt;const r=Ot(t,e);return r!==nt&&(t.state=null),r};let Nt,bt,It=!0;const Ct=t=>{if(It){Nt=new Int32Array(512),bt=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Q(1,t.lens,0,288,Nt,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Q(2,t.lens,0,32,bt,0,t.work,{bits:5}),It=!1}t.lencode=Nt,t.lenbits=9,t.distcode=bt,t.distbits=5},St=(t,e,n,r)=>{let o;const i=t.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(e.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(o=i.wsize-i.wnext,o>r&&(o=r),i.window.set(e.subarray(n-r,n-r+o),i.wnext),(r-=o)?(i.window.set(e.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=o,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=o))),0};var xt={inflateReset:vt,inflateReset2:Ot,inflateResetKeep:At,inflateInit:t=>Tt(t,15),inflateInit2:Tt,inflate:(t,e)=>{let n,r,o,i,s,a,c,u,l,d,h,f,p,_,y,m,g,w,R,E,A,v,O=0;const T=new Uint8Array(4);let N,b;const I=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Et(t)||!t.output||!t.input&&0!==t.avail_in)return it;n=t.state,n.mode===ht&&(n.mode=ft),s=t.next_out,o=t.output,c=t.avail_out,i=t.next_in,r=t.input,a=t.avail_in,u=n.hold,l=n.bits,d=a,h=c,v=nt;t:for(;;)switch(n.mode){case lt:if(0===n.wrap){n.mode=ft;break}for(;l<16;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}if(2&n.wrap&&35615===u){0===n.wbits&&(n.wbits=15),n.check=0,T[0]=255&u,T[1]=u>>>8&255,n.check=D(n.check,T,2,0),u=0,l=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&u)<<8)+(u>>8))%31){t.msg="incorrect header check",n.mode=gt;break}if((15&u)!==ut){t.msg="unknown compression method",n.mode=gt;break}if(u>>>=4,l-=4,A=8+(15&u),0===n.wbits&&(n.wbits=A),A>15||A>n.wbits){t.msg="invalid window size",n.mode=gt;break}n.dmax=1<<n.wbits,n.flags=0,t.adler=n.check=1,n.mode=512&u?16189:ht,u=0,l=0;break;case 16181:for(;l<16;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}if(n.flags=u,(255&n.flags)!==ut){t.msg="unknown compression method",n.mode=gt;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=gt;break}n.head&&(n.head.text=u>>8&1),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=D(n.check,T,2,0)),u=0,l=0,n.mode=16182;case 16182:for(;l<32;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}n.head&&(n.head.time=u),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,T[2]=u>>>16&255,T[3]=u>>>24&255,n.check=D(n.check,T,4,0)),u=0,l=0,n.mode=16183;case 16183:for(;l<16;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}n.head&&(n.head.xflags=255&u,n.head.os=u>>8),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=D(n.check,T,2,0)),u=0,l=0,n.mode=16184;case 16184:if(1024&n.flags){for(;l<16;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}n.length=u,n.head&&(n.head.extra_len=u),512&n.flags&&4&n.wrap&&(T[0]=255&u,T[1]=u>>>8&255,n.check=D(n.check,T,2,0)),u=0,l=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(f=n.length,f>a&&(f=a),f&&(n.head&&(A=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+f),A)),512&n.flags&&4&n.wrap&&(n.check=D(n.check,r,f,i)),a-=f,i+=f,n.length-=f),n.length))break t;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===a)break t;f=0;do{A=r[i+f++],n.head&&A&&n.length<65536&&(n.head.name+=String.fromCharCode(A))}while(A&&f<a);if(512&n.flags&&4&n.wrap&&(n.check=D(n.check,r,f,i)),a-=f,i+=f,A)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===a)break t;f=0;do{A=r[i+f++],n.head&&A&&n.length<65536&&(n.head.comment+=String.fromCharCode(A))}while(A&&f<a);if(512&n.flags&&4&n.wrap&&(n.check=D(n.check,r,f,i)),a-=f,i+=f,A)break t}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;l<16;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}if(4&n.wrap&&u!==(65535&n.check)){t.msg="header crc mismatch",n.mode=gt;break}u=0,l=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=ht;break;case 16189:for(;l<32;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}t.adler=n.check=wt(u),u=0,l=0,n.mode=dt;case dt:if(0===n.havedict)return t.next_out=s,t.avail_out=c,t.next_in=i,t.avail_in=a,n.hold=u,n.bits=l,ot;t.adler=n.check=1,n.mode=ht;case ht:if(e===tt||e===et)break t;case ft:if(n.last){u>>>=7&l,l-=7&l,n.mode=mt;break}for(;l<3;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}switch(n.last=1&u,u>>>=1,l-=1,3&u){case 0:n.mode=16193;break;case 1:if(Ct(n),n.mode=_t,e===et){u>>>=2,l-=2;break t}break;case 2:n.mode=16196;break;case 3:t.msg="invalid block type",n.mode=gt}u>>>=2,l-=2;break;case 16193:for(u>>>=7&l,l-=7&l;l<32;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}if((65535&u)!=(u>>>16^65535)){t.msg="invalid stored block lengths",n.mode=gt;break}if(n.length=65535&u,u=0,l=0,n.mode=pt,e===et)break t;case pt:n.mode=16195;case 16195:if(f=n.length,f){if(f>a&&(f=a),f>c&&(f=c),0===f)break t;o.set(r.subarray(i,i+f),s),a-=f,i+=f,c-=f,s+=f,n.length-=f;break}n.mode=ht;break;case 16196:for(;l<14;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}if(n.nlen=257+(31&u),u>>>=5,l-=5,n.ndist=1+(31&u),u>>>=5,l-=5,n.ncode=4+(15&u),u>>>=4,l-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=gt;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;l<3;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}n.lens[I[n.have++]]=7&u,u>>>=3,l-=3}for(;n.have<19;)n.lens[I[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,N={bits:n.lenbits},v=Q(0,n.lens,0,19,n.lencode,0,n.work,N),n.lenbits=N.bits,v){t.msg="invalid code lengths set",n.mode=gt;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;O=n.lencode[u&(1<<n.lenbits)-1],y=O>>>24,m=O>>>16&255,g=65535&O,!(y<=l);){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}if(g<16)u>>>=y,l-=y,n.lens[n.have++]=g;else{if(16===g){for(b=y+2;l<b;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}if(u>>>=y,l-=y,0===n.have){t.msg="invalid bit length repeat",n.mode=gt;break}A=n.lens[n.have-1],f=3+(3&u),u>>>=2,l-=2}else if(17===g){for(b=y+3;l<b;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}u>>>=y,l-=y,A=0,f=3+(7&u),u>>>=3,l-=3}else{for(b=y+7;l<b;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}u>>>=y,l-=y,A=0,f=11+(127&u),u>>>=7,l-=7}if(n.have+f>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=gt;break}for(;f--;)n.lens[n.have++]=A}}if(n.mode===gt)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=gt;break}if(n.lenbits=9,N={bits:n.lenbits},v=Q(1,n.lens,0,n.nlen,n.lencode,0,n.work,N),n.lenbits=N.bits,v){t.msg="invalid literal/lengths set",n.mode=gt;break}if(n.distbits=6,n.distcode=n.distdyn,N={bits:n.distbits},v=Q(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,N),n.distbits=N.bits,v){t.msg="invalid distances set",n.mode=gt;break}if(n.mode=_t,e===et)break t;case _t:n.mode=yt;case yt:if(a>=6&&c>=258){t.next_out=s,t.avail_out=c,t.next_in=i,t.avail_in=a,n.hold=u,n.bits=l,$(t,h),s=t.next_out,o=t.output,c=t.avail_out,i=t.next_in,r=t.input,a=t.avail_in,u=n.hold,l=n.bits,n.mode===ht&&(n.back=-1);break}for(n.back=0;O=n.lencode[u&(1<<n.lenbits)-1],y=O>>>24,m=O>>>16&255,g=65535&O,!(y<=l);){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}if(m&&!(240&m)){for(w=y,R=m,E=g;O=n.lencode[E+((u&(1<<w+R)-1)>>w)],y=O>>>24,m=O>>>16&255,g=65535&O,!(w+y<=l);){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}u>>>=w,l-=w,n.back+=w}if(u>>>=y,l-=y,n.back+=y,n.length=g,0===m){n.mode=16205;break}if(32&m){n.back=-1,n.mode=ht;break}if(64&m){t.msg="invalid literal/length code",n.mode=gt;break}n.extra=15&m,n.mode=16201;case 16201:if(n.extra){for(b=n.extra;l<b;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;O=n.distcode[u&(1<<n.distbits)-1],y=O>>>24,m=O>>>16&255,g=65535&O,!(y<=l);){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}if(!(240&m)){for(w=y,R=m,E=g;O=n.distcode[E+((u&(1<<w+R)-1)>>w)],y=O>>>24,m=O>>>16&255,g=65535&O,!(w+y<=l);){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}u>>>=w,l-=w,n.back+=w}if(u>>>=y,l-=y,n.back+=y,64&m){t.msg="invalid distance code",n.mode=gt;break}n.offset=g,n.extra=15&m,n.mode=16203;case 16203:if(n.extra){for(b=n.extra;l<b;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,l-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=gt;break}n.mode=16204;case 16204:if(0===c)break t;if(f=h-c,n.offset>f){if(f=n.offset-f,f>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=gt;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),_=n.window}else _=o,p=s-n.offset,f=n.length;f>c&&(f=c),c-=f,n.length-=f;do{o[s++]=_[p++]}while(--f);0===n.length&&(n.mode=yt);break;case 16205:if(0===c)break t;o[s++]=n.length,c--,n.mode=yt;break;case mt:if(n.wrap){for(;l<32;){if(0===a)break t;a--,u|=r[i++]<<l,l+=8}if(h-=c,t.total_out+=h,n.total+=h,4&n.wrap&&h&&(t.adler=n.check=n.flags?D(n.check,o,h,s-h):x(n.check,o,h,s-h)),h=c,4&n.wrap&&(n.flags?u:wt(u))!==n.check){t.msg="incorrect data check",n.mode=gt;break}u=0,l=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;l<32;){if(0===a)break t;a--,u+=r[i++]<<l,l+=8}if(4&n.wrap&&u!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=gt;break}u=0,l=0}n.mode=16208;case 16208:v=rt;break t;case gt:v=st;break t;case 16210:return at;default:return it}return t.next_out=s,t.avail_out=c,t.next_in=i,t.avail_in=a,n.hold=u,n.bits=l,(n.wsize||h!==t.avail_out&&n.mode<gt&&(n.mode<mt||e!==J))&&St(t,t.output,t.next_out,h-t.avail_out),d-=t.avail_in,h-=t.avail_out,t.total_in+=d,t.total_out+=h,n.total+=h,4&n.wrap&&h&&(t.adler=n.check=n.flags?D(n.check,o,h,t.next_out-h):x(n.check,o,h,t.next_out-h)),t.data_type=n.bits+(n.last?64:0)+(n.mode===ht?128:0)+(n.mode===_t||n.mode===pt?256:0),(0===d&&0===h||e===J)&&v===nt&&(v=ct),v},inflateEnd:t=>{if(Et(t))return it;let e=t.state;return e.window&&(e.window=null),t.state=null,nt},inflateGetHeader:(t,e)=>{if(Et(t))return it;const n=t.state;return 2&n.wrap?(n.head=e,e.done=!1,nt):it},inflateSetDictionary:(t,e)=>{const n=e.length;let r,o,i;return Et(t)?it:(r=t.state,0!==r.wrap&&r.mode!==dt?it:r.mode===dt&&(o=1,o=x(o,e,n,0),o!==r.check)?st:(i=St(t,e,n,n),i?(r.mode=16210,at):(r.havedict=1,nt)))},inflateInfo:"pako inflate (from Nodeca project)"};var kt=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Dt=Object.prototype.toString,{Z_NO_FLUSH:Mt,Z_FINISH:Pt,Z_OK:Lt,Z_STREAM_END:Ut,Z_NEED_DICT:Ht,Z_STREAM_ERROR:Bt,Z_DATA_ERROR:Gt,Z_MEM_ERROR:Vt}=P;function jt(t){this.options=U({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(15&e.windowBits||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new K,this.strm.avail_out=0;let n=xt.inflateInit2(this.strm,e.windowBits);if(n!==Lt)throw new Error(M[n]);if(this.header=new kt,xt.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=V(e.dictionary):"[object ArrayBuffer]"===Dt.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=xt.inflateSetDictionary(this.strm,e.dictionary),n!==Lt)))throw new Error(M[n])}jt.prototype.push=function(t,e){const n=this.strm,r=this.options.chunkSize,o=this.options.dictionary;let i,s,a;if(this.ended)return!1;for(s=e===~~e?e:!0===e?Pt:Mt,"[object ArrayBuffer]"===Dt.call(t)?n.input=new Uint8Array(t):n.input=t,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=xt.inflate(n,s),i===Ht&&o&&(i=xt.inflateSetDictionary(n,o),i===Lt?i=xt.inflate(n,s):i===Gt&&(i=Ht));n.avail_in>0&&i===Ut&&n.state.wrap>0&&0!==t[n.next_in];)xt.inflateReset(n),i=xt.inflate(n,s);switch(i){case Bt:case Gt:case Ht:case Vt:return this.onEnd(i),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||i===Ut))if("string"===this.options.to){let t=z(n.output,n.next_out),e=n.next_out-t,o=j(n.output,t);n.next_out=e,n.avail_out=r-e,e&&n.output.set(n.output.subarray(t,t+e),0),this.onData(o)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(i!==Lt||0!==a){if(i===Ut)return i=xt.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},jt.prototype.onData=function(t){this.chunks.push(t)},jt.prototype.onEnd=function(t){t===Lt&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=H(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var zt={inflate:function(t,e){const n=new jt(e);if(n.push(t),n.err)throw n.msg||M[n.err];return n.result}};const{inflate:Kt}=zt;var Ft,$t=Kt,qt={exports:{}};const Zt=g((Ft||(Ft=1,function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(t,e,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||t,s),c=n?n+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],a]:t._events[c].push(a):(t._events[c]=a,t._eventsCount++),t}function s(t,e){0===--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,r,o=[];if(0===this._eventsCount)return o;for(r in t=this._events)e.call(t,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,s=new Array(i);o<i;o++)s[o]=r[o].fn;return s},a.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,o,i,s){var a=n?n+t:t;if(!this._events[a])return!1;var c,u,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,o),!0;case 5:return l.fn.call(l.context,e,r,o,i),!0;case 6:return l.fn.call(l.context,e,r,o,i,s),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,r);break;case 4:l[u].fn.call(l[u].context,e,r,o);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(t,e,n){return i(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return i(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,r,o){var i=n?n+t:t;if(!this._events[i])return this;if(!e)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||r&&a.context!==r||s(this,i);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==e||o&&!a[c].once||r&&a[c].context!==r)&&u.push(a[c]);u.length?this._events[i]=1===u.length?u[0]:u:s(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&s(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}(qt)),qt.exports));const Wt=t=>"version"in t;function Xt(t){return r.encode(t)}function Yt(t){return i.Buffer.from(t,"base64")}function Qt(t){return"accounts"in t}const Jt=C.struct([C.publicKey("authority"),C.vecU8("data")]);function te(t,e,n,r){return(null==t?void 0:t.length)?t[0].name?n(t):r(t):e()}function ee(t,...e){if(t.args.length!=e.length)throw new Error("Invalid argument length");const n={};let r=0;return t.args.forEach(t=>{n[t.name]=e[r],r+=1}),n}function ne(t,e={}){t.forEach(t=>{if(Qt(t))ne(t.accounts,e[t.name]);else if(!e[t.name])throw new Error(`Account \`${t.name}\` not provided.`)})}function re(t){return t instanceof o?t:new o(t)}class oe extends TypeError{constructor(t,e){let n;const{message:r,...o}=t,{path:i}=t;super(0===i.length?r:"At path: "+i.join(".")+" -- "+r),this.value=void 0,this.key=void 0,this.type=void 0,this.refinement=void 0,this.path=void 0,this.branch=void 0,this.failures=void 0,Object.assign(this,o),this.name=this.constructor.name,this.failures=()=>{var r;return null!=(r=n)?r:n=[t,...e()]}}}function ie(t){return"object"==typeof t&&null!=t}function se(t){return"string"==typeof t?JSON.stringify(t):""+t}function ae(t,e,n,r){if(!0===t)return;!1===t?t={}:"string"==typeof t&&(t={message:t});const{path:o,branch:i}=e,{type:s}=n,{refinement:a,message:c="Expected a value of type `"+s+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+se(r)+"`"}=t;return{value:r,type:s,refinement:a,key:o[o.length-1],path:o,branch:i,...t,message:c}}function*ce(t,e,n,r){var o;ie(o=t)&&"function"==typeof o[Symbol.iterator]||(t=[t]);for(const i of t){const t=ae(i,e,n,r);t&&(yield t)}}function*ue(t,e,n){void 0===n&&(n={});const{path:r=[],branch:o=[t],coerce:i=!1,mask:s=!1}=n,a={path:r,branch:o};if(i&&(t=e.coercer(t,a),s&&"type"!==e.type&&ie(e.schema)&&ie(t)&&!Array.isArray(t)))for(const u in t)void 0===e.schema[u]&&delete t[u];let c=!0;for(const u of e.validator(t,a))c=!1,yield[u,void 0];for(let[u,l,d]of e.entries(t,a)){const e=ue(l,d,{path:void 0===u?r:[...r,u],branch:void 0===u?o:[...o,l],coerce:i,mask:s});for(const n of e)n[0]?(c=!1,yield[n[0],void 0]):i&&(l=n[1],void 0===u?t=l:t instanceof Map?t.set(u,l):t instanceof Set?t.add(l):ie(t)&&(t[u]=l))}if(c)for(const u of e.refiner(t,a))c=!1,yield[u,void 0];c&&(yield[void 0,t])}class le{constructor(t){this.TYPE=void 0,this.type=void 0,this.schema=void 0,this.coercer=void 0,this.validator=void 0,this.refiner=void 0,this.entries=void 0;const{type:e,schema:n,validator:r,refiner:o,coercer:i=t=>t,entries:s=function*(){}}=t;this.type=e,this.schema=n,this.entries=s,this.coercer=i,this.validator=r?(t,e)=>ce(r(t,e),e,this,t):()=>[],this.refiner=o?(t,e)=>ce(o(t,e),e,this,t):()=>[]}assert(t){return function(t,e){const n=fe(t,e);if(n[0])throw n[0]}(t,this)}create(t){return de(t,this)}is(t){return he(t,this)}mask(t){return function(t,e){const n=fe(t,e,{coerce:!0,mask:!0});if(n[0])throw n[0];return n[1]}(t,this)}validate(t,e){return void 0===e&&(e={}),fe(t,this,e)}}function de(t,e){const n=fe(t,e,{coerce:!0});if(n[0])throw n[0];return n[1]}function he(t,e){return!fe(t,e)[0]}function fe(t,e,n){void 0===n&&(n={});const r=ue(t,e,n),o=function(t){const{done:e,value:n}=t.next();return e?void 0:n}(r);if(o[0]){return[new oe(o[0],function*(){for(const t of r)t[0]&&(yield t[0])}),void 0]}return[void 0,o[1]]}function pe(t,e){return new le({type:t,schema:null,validator:e})}function _e(t){return new le({type:"array",schema:t,*entries(e){if(t&&Array.isArray(e))for(const[n,r]of e.entries())yield[n,r,t]},coercer:t=>Array.isArray(t)?t.slice():t,validator:t=>Array.isArray(t)||"Expected an array value, but received: "+se(t)})}function ye(t){const e=se(t);return new le({type:"literal",schema:t,validator:n=>n===t||"Expected the literal `"+e+"`, but received: "+se(n)})}function me(t){return new le({...t,validator:(e,n)=>null===e||t.validator(e,n),refiner:(e,n)=>null===e||t.refiner(e,n)})}function ge(){return pe("number",t=>"number"==typeof t&&!isNaN(t)||"Expected a number, but received: "+se(t))}function we(t){return new le({...t,validator:(e,n)=>void 0===e||t.validator(e,n),refiner:(e,n)=>void 0===e||t.refiner(e,n)})}function Re(){return pe("string",t=>"string"==typeof t||"Expected a string, but received: "+se(t))}function Ee(t){const e=Object.keys(t);return new le({type:"type",schema:t,*entries(n){if(ie(n))for(const r of e)yield[r,n[r],t[r]]},validator:t=>ie(t)||"Expected an object, but received: "+se(t)})}function Ae(t){const e=t.map(t=>t.type).join(" | ");return new le({type:"union",schema:null,coercer:(e,n)=>(t.find(t=>{const[n]=t.validate(e,{coerce:!0});return!n})||ve()).coercer(e,n),validator(n,r){const o=[];for(const e of t){const[...t]=ue(n,e,r),[i]=t;if(!i[0])return[];for(const[e]of t)e&&o.push(e)}return["Expected the value to satisfy a union of `"+e+"`, but received: "+se(n),...o]}})}function ve(){return pe("unknown",()=>!0)}async function Oe(t,e,n){if(e.length<=99)return await Te(t,e,n);{const i=(r=e,o=99,Array.apply(0,new Array(Math.ceil(r.length/o))).map((t,e)=>r.slice(e*o,(e+1)*o)));return(await Promise.all(i.map(e=>Te(t,e,n)))).flat()}var r,o}async function Te(t,e,n){const r=null!=n?n:t.commitment,{value:o,context:i}=await t.getMultipleAccountsInfoAndContext(e,r);return o.map((t,n)=>null===t?null:{publicKey:e[n],account:t,context:i})}function Ne(t){return e=Ie(t),n=be,r=e=>"error"in e?e:{...e,result:de(e.result,t)},new le({...e,coercer:(t,o)=>he(t,n)?e.coercer(r(t,o),o):e.coercer(t,o)});var e,n,r}const be=Ie(ve());function Ie(t){return Ae([Ee({jsonrpc:ye("2.0"),id:Re(),result:t}),Ee({jsonrpc:ye("2.0"),id:Re(),error:Ee({code:ve(),message:Re(),data:we(pe("any",()=>!0))})})])}const Ce=(Se=Ee({err:me(Ae([Ee({}),Re()])),logs:me(_e(Re())),accounts:we(me(_e(me(Ee({executable:pe("boolean",t=>"boolean"==typeof t),owner:Re(),lamports:ge(),data:_e(Re()),rentEpoch:we(ge())}))))),unitsConsumed:we(ge())}),Ne(Ee({context:Ee({slot:ge()}),value:Se})));var Se;class xe{constructor(t,e,n=xe.defaultOptions()){this.connection=t,this.wallet=e,this.opts=n,this.publicKey=null==e?void 0:e.publicKey}static defaultOptions(){return{preflightCommitment:"processed",commitment:"processed"}}static local(t,e=xe.defaultOptions()){throw new Error("Provider local is not available on browser.")}static env(){throw new Error("Provider env is not available on browser.")}async sendAndConfirm(t,e,r){var o,i,s,a;if(void 0===r&&(r=this.opts),Wt(t))e&&t.sign(e);else if(t.feePayer=null!==(o=t.feePayer)&&void 0!==o?o:this.wallet.publicKey,t.recentBlockhash=(await this.connection.getLatestBlockhash(r.preflightCommitment)).blockhash,e)for(const n of e)t.partialSign(n);const c=(t=await this.wallet.signTransaction(t)).serialize();try{return await De(this.connection,c,r)}catch(u){if(u instanceof Me){const e=Xt(Wt(t)?(null===(i=t.signatures)||void 0===i?void 0:i[0])||new Uint8Array:null!==(s=t.signature)&&void 0!==s?s:new Uint8Array),r=Wt(t)?0:void 0,o=await this.connection.getTransaction(e,{commitment:"confirmed",maxSupportedTransactionVersion:r});if(o){const t=null===(a=o.meta)||void 0===a?void 0:a.logMessages;throw t?new n(u.message,t):u}throw u}throw u}}async sendAll(t,e){var r,o,i;void 0===e&&(e=this.opts);const s=(await this.connection.getLatestBlockhash(e.preflightCommitment)).blockhash;let a=t.map(t=>{var e,n;if(Wt(t.tx)){let e=t.tx;return t.signers&&e.sign(t.signers),e}{let r=t.tx,o=null!==(e=t.signers)&&void 0!==e?e:[];return r.feePayer=null!==(n=r.feePayer)&&void 0!==n?n:this.wallet.publicKey,r.recentBlockhash=s,o.forEach(t=>{r.partialSign(t)}),r}});const c=await this.wallet.signAllTransactions(a),u=[];for(let d=0;d<a.length;d+=1){const t=c[d],s=t.serialize();try{u.push(await De(this.connection,s,e))}catch(l){if(l instanceof Me){const e=Xt(Wt(t)?(null===(r=t.signatures)||void 0===r?void 0:r[0])||new Uint8Array:null!==(o=t.signature)&&void 0!==o?o:new Uint8Array),s=Wt(t)?0:void 0,a=await this.connection.getTransaction(e,{commitment:"confirmed",maxSupportedTransactionVersion:s});if(a){const t=null===(i=a.meta)||void 0===i?void 0:i.logMessages;throw t?new n(l.message,t):l}throw l}throw l}}return u}async simulate(t,e,r,o){let i,s=(await this.connection.getLatestBlockhash(null!=r?r:this.connection.commitment)).blockhash;if(Wt(t)?(e&&e.length>0&&(t.sign(e),t=await this.wallet.signTransaction(t)),i=await this.connection.simulateTransaction(t,{commitment:r})):(t.feePayer=t.feePayer||this.wallet.publicKey,t.recentBlockhash=s,e&&e.length>0&&(t=await this.wallet.signTransaction(t)),i=await async function(t,e,r,o,i){var s;r&&r.length>0&&e.sign(...r);const a=e._compile(),c=a.serialize(),u=e._serialize(c).toString("base64"),l={encoding:"base64",commitment:null!=o?o:t.commitment};if(i){const t=(Array.isArray(i)?i:a.nonProgramIds()).map(t=>t.toBase58());l.accounts={encoding:"base64",addresses:t}}r&&r.length>0&&(l.sigVerify=!0);const d=[u,l],h=de(await t._rpcRequest("simulateTransaction",d),Ce);if("error"in h){let t;if("data"in h.error&&(t=null===(s=h.error.data)||void 0===s?void 0:s.logs,t&&Array.isArray(t))){const e="\n    ",n=e+t.join(e);console.error(h.error.message,n)}throw new n("failed to simulate transaction: "+h.error.message,t)}return h.result}(this.connection,t,e,r,o)),i.value.err)throw new ke(i.value);return i.value}}class ke extends Error{constructor(t,e){super(e),this.simulationResponse=t}}async function De(t,e,n){const r=n?{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot}:{};let o;const i=Date.now();for(;Date.now()-i<6e4;)try{const i=await t.sendRawTransaction(e,r);if(null==n?void 0:n.blockhash)if(0===r.maxRetries){const e=AbortSignal.timeout(15e3);o=(await t.confirmTransaction({abortSignal:e,signature:i,...n.blockhash},n&&n.commitment)).value}else o=(await t.confirmTransaction({signature:i,...n.blockhash},n&&n.commitment)).value;else o=(await t.confirmTransaction(i,n&&n.commitment)).value;if(o.err)throw new Me(`Raw transaction ${i} failed (${JSON.stringify(o)})`);return i}catch(s){if("TimeoutError"===s.name)continue;throw s}throw Error("Transaction failed to confirm in 60s")}class Me extends Error{constructor(t){super(t)}}function Pe(){return xe.local()}var Le="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},Ue={};Object.defineProperty(Ue,"__esModule",{value:!0});var He=Ue.ANCHOR_ERROR__REQUIRE_EQ_VIOLATED=Ue.ANCHOR_ERROR__REQUIRE_VIOLATED=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION_PROGRAM_ID=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION_AUTHORITY=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_PERMANENT_DELEGATE_EXTENSION_DELEGATE=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_PERMANENT_DELEGATE_EXTENSION=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_CLOSE_AUTHORITY_EXTENSION_AUTHORITY=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_CLOSE_AUTHORITY_EXTENSION=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION_METADATA_ADDRESS=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION_AUTHORITY=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION_MEMBER_ADDRESS=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION_AUTHORITY=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION_GROUP_ADDRESS=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION_AUTHORITY=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION=Ue.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED_TOKEN_TOKEN_PROGRAM=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_TOKEN_PROGRAM=Ue.ANCHOR_ERROR__CONSTRAINT_TOKEN_TOKEN_PROGRAM=Ue.ANCHOR_ERROR__CONSTRAINT_ACCOUNT_IS_NONE=Ue.ANCHOR_ERROR__CONSTRAINT_SPACE=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_DECIMALS=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_FREEZE_AUTHORITY=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_MINT_AUTHORITY=Ue.ANCHOR_ERROR__CONSTRAINT_TOKEN_OWNER=Ue.ANCHOR_ERROR__CONSTRAINT_TOKEN_MINT=Ue.ANCHOR_ERROR__CONSTRAINT_ZERO=Ue.ANCHOR_ERROR__CONSTRAINT_ADDRESS=Ue.ANCHOR_ERROR__CONSTRAINT_CLOSE=Ue.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED_INIT=Ue.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED=Ue.ANCHOR_ERROR__CONSTRAINT_STATE=Ue.ANCHOR_ERROR__CONSTRAINT_EXECUTABLE=Ue.ANCHOR_ERROR__CONSTRAINT_SEEDS=Ue.ANCHOR_ERROR__CONSTRAINT_RENT_EXEMPT=Ue.ANCHOR_ERROR__CONSTRAINT_OWNER=Ue.ANCHOR_ERROR__CONSTRAINT_RAW=Ue.ANCHOR_ERROR__CONSTRAINT_SIGNER=Ue.ANCHOR_ERROR__CONSTRAINT_HAS_ONE=Ue.ANCHOR_ERROR__CONSTRAINT_MUT=Ue.ANCHOR_ERROR__EVENT_INSTRUCTION_STUB=Ue.ANCHOR_ERROR__IDL_ACCOUNT_NOT_EMPTY=Ue.ANCHOR_ERROR__IDL_INSTRUCTION_INVALID_PROGRAM=Ue.ANCHOR_ERROR__IDL_INSTRUCTION_STUB=Ue.ANCHOR_ERROR__INSTRUCTION_DID_NOT_SERIALIZE=Ue.ANCHOR_ERROR__INSTRUCTION_DID_NOT_DESERIALIZE=Ue.ANCHOR_ERROR__INSTRUCTION_FALLBACK_NOT_FOUND=Ue.ANCHOR_ERROR__INSTRUCTION_MISSING=void 0,Be=Ue.ANCHOR_ERROR__DEPRECATED=Ue.ANCHOR_ERROR__INVALID_NUMERIC_CONVERSION=Ue.ANCHOR_ERROR__TRYING_TO_INIT_PAYER_AS_PROGRAM_ACCOUNT=Ue.ANCHOR_ERROR__DECLARED_PROGRAM_ID_MISMATCH=Ue.ANCHOR_ERROR__ACCOUNT_DUPLICATE_REALLOCS=Ue.ANCHOR_ERROR__ACCOUNT_REALLOC_EXCEEDS_LIMIT=Ue.ANCHOR_ERROR__ACCOUNT_SYSVAR_MISMATCH=Ue.ANCHOR_ERROR__ACCOUNT_NOT_ASSOCIATED_TOKEN_ACCOUNT=Ue.ANCHOR_ERROR__ACCOUNT_NOT_PROGRAM_DATA=Ue.ANCHOR_ERROR__ACCOUNT_NOT_INITIALIZED=Ue.ANCHOR_ERROR__ACCOUNT_NOT_SYSTEM_OWNED=Ue.ANCHOR_ERROR__ACCOUNT_NOT_SIGNER=Ue.ANCHOR_ERROR__INVALID_PROGRAM_EXECUTABLE=Ue.ANCHOR_ERROR__INVALID_PROGRAM_ID=Ue.ANCHOR_ERROR__ACCOUNT_OWNED_BY_WRONG_PROGRAM=Ue.ANCHOR_ERROR__ACCOUNT_NOT_MUTABLE=Ue.ANCHOR_ERROR__ACCOUNT_NOT_ENOUGH_KEYS=Ue.ANCHOR_ERROR__ACCOUNT_DID_NOT_SERIALIZE=Ue.ANCHOR_ERROR__ACCOUNT_DID_NOT_DESERIALIZE=Ue.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_MISMATCH=Ue.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_NOT_FOUND=Ue.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_ALREADY_SET=Ue.ANCHOR_ERROR__REQUIRE_GTE_VIOLATED=Ue.ANCHOR_ERROR__REQUIRE_GT_VIOLATED=Ue.ANCHOR_ERROR__REQUIRE_KEYS_NEQ_VIOLATED=Ue.ANCHOR_ERROR__REQUIRE_NEQ_VIOLATED=Ue.ANCHOR_ERROR__REQUIRE_KEYS_EQ_VIOLATED=void 0,Ge=Ue.ANCHOR_ERROR__INSTRUCTION_MISSING=100,Ve=Ue.ANCHOR_ERROR__INSTRUCTION_FALLBACK_NOT_FOUND=101,je=Ue.ANCHOR_ERROR__INSTRUCTION_DID_NOT_DESERIALIZE=102,ze=Ue.ANCHOR_ERROR__INSTRUCTION_DID_NOT_SERIALIZE=103,Ke=Ue.ANCHOR_ERROR__IDL_INSTRUCTION_STUB=1e3,Fe=Ue.ANCHOR_ERROR__IDL_INSTRUCTION_INVALID_PROGRAM=1001,$e=Ue.ANCHOR_ERROR__IDL_ACCOUNT_NOT_EMPTY=1002,qe=Ue.ANCHOR_ERROR__EVENT_INSTRUCTION_STUB=1500,Ze=Ue.ANCHOR_ERROR__CONSTRAINT_MUT=2e3,We=Ue.ANCHOR_ERROR__CONSTRAINT_HAS_ONE=2001,Xe=Ue.ANCHOR_ERROR__CONSTRAINT_SIGNER=2002,Ye=Ue.ANCHOR_ERROR__CONSTRAINT_RAW=2003,Qe=Ue.ANCHOR_ERROR__CONSTRAINT_OWNER=2004,Je=Ue.ANCHOR_ERROR__CONSTRAINT_RENT_EXEMPT=2005,tn=Ue.ANCHOR_ERROR__CONSTRAINT_SEEDS=2006,en=Ue.ANCHOR_ERROR__CONSTRAINT_EXECUTABLE=2007,nn=Ue.ANCHOR_ERROR__CONSTRAINT_STATE=2008,rn=Ue.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED=2009,on=Ue.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED_INIT=2010,sn=Ue.ANCHOR_ERROR__CONSTRAINT_CLOSE=2011,an=Ue.ANCHOR_ERROR__CONSTRAINT_ADDRESS=2012,cn=Ue.ANCHOR_ERROR__CONSTRAINT_ZERO=2013,un=Ue.ANCHOR_ERROR__CONSTRAINT_TOKEN_MINT=2014,ln=Ue.ANCHOR_ERROR__CONSTRAINT_TOKEN_OWNER=2015,dn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_MINT_AUTHORITY=2016,hn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_FREEZE_AUTHORITY=2017,fn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_DECIMALS=2018,pn=Ue.ANCHOR_ERROR__CONSTRAINT_SPACE=2019,_n=Ue.ANCHOR_ERROR__CONSTRAINT_ACCOUNT_IS_NONE=2020,yn=Ue.ANCHOR_ERROR__CONSTRAINT_TOKEN_TOKEN_PROGRAM=2021,mn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_TOKEN_PROGRAM=2022,gn=Ue.ANCHOR_ERROR__CONSTRAINT_ASSOCIATED_TOKEN_TOKEN_PROGRAM=2023,wn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION=2024,Rn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION_AUTHORITY=2025,En=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_POINTER_EXTENSION_GROUP_ADDRESS=2026,An=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION=2027,vn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION_AUTHORITY=2028,On=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_GROUP_MEMBER_POINTER_EXTENSION_MEMBER_ADDRESS=2029,Tn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION=2030,Nn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION_AUTHORITY=2031,bn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_METADATA_POINTER_EXTENSION_METADATA_ADDRESS=2032,In=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_CLOSE_AUTHORITY_EXTENSION=2033,Cn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_CLOSE_AUTHORITY_EXTENSION_AUTHORITY=2034,Sn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_PERMANENT_DELEGATE_EXTENSION=2035,xn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_PERMANENT_DELEGATE_EXTENSION_DELEGATE=2036,kn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION=2037,Dn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION_AUTHORITY=2038,Mn=Ue.ANCHOR_ERROR__CONSTRAINT_MINT_TRANSFER_HOOK_EXTENSION_PROGRAM_ID=2039,Pn=Ue.ANCHOR_ERROR__REQUIRE_VIOLATED=2500;He=Ue.ANCHOR_ERROR__REQUIRE_EQ_VIOLATED=2501;var Ln=Ue.ANCHOR_ERROR__REQUIRE_KEYS_EQ_VIOLATED=2502,Un=Ue.ANCHOR_ERROR__REQUIRE_NEQ_VIOLATED=2503,Hn=Ue.ANCHOR_ERROR__REQUIRE_KEYS_NEQ_VIOLATED=2504,Bn=Ue.ANCHOR_ERROR__REQUIRE_GT_VIOLATED=2505,Gn=Ue.ANCHOR_ERROR__REQUIRE_GTE_VIOLATED=2506,Vn=Ue.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_ALREADY_SET=3e3,jn=Ue.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_NOT_FOUND=3001,zn=Ue.ANCHOR_ERROR__ACCOUNT_DISCRIMINATOR_MISMATCH=3002,Kn=Ue.ANCHOR_ERROR__ACCOUNT_DID_NOT_DESERIALIZE=3003,Fn=Ue.ANCHOR_ERROR__ACCOUNT_DID_NOT_SERIALIZE=3004,$n=Ue.ANCHOR_ERROR__ACCOUNT_NOT_ENOUGH_KEYS=3005,qn=Ue.ANCHOR_ERROR__ACCOUNT_NOT_MUTABLE=3006,Zn=Ue.ANCHOR_ERROR__ACCOUNT_OWNED_BY_WRONG_PROGRAM=3007,Wn=Ue.ANCHOR_ERROR__INVALID_PROGRAM_ID=3008,Xn=Ue.ANCHOR_ERROR__INVALID_PROGRAM_EXECUTABLE=3009,Yn=Ue.ANCHOR_ERROR__ACCOUNT_NOT_SIGNER=3010,Qn=Ue.ANCHOR_ERROR__ACCOUNT_NOT_SYSTEM_OWNED=3011,Jn=Ue.ANCHOR_ERROR__ACCOUNT_NOT_INITIALIZED=3012,tr=Ue.ANCHOR_ERROR__ACCOUNT_NOT_PROGRAM_DATA=3013,er=Ue.ANCHOR_ERROR__ACCOUNT_NOT_ASSOCIATED_TOKEN_ACCOUNT=3014,nr=Ue.ANCHOR_ERROR__ACCOUNT_SYSVAR_MISMATCH=3015,rr=Ue.ANCHOR_ERROR__ACCOUNT_REALLOC_EXCEEDS_LIMIT=3016,or=Ue.ANCHOR_ERROR__ACCOUNT_DUPLICATE_REALLOCS=3017,ir=Ue.ANCHOR_ERROR__DECLARED_PROGRAM_ID_MISMATCH=4100,sr=Ue.ANCHOR_ERROR__TRYING_TO_INIT_PAYER_AS_PROGRAM_ACCOUNT=4101,ar=Ue.ANCHOR_ERROR__INVALID_NUMERIC_CONVERSION=4102;Be=Ue.ANCHOR_ERROR__DEPRECATED=5e3;const cr=new Map;function ur(t){return void 0!==cr.get(t)}class lr extends Error{constructor(t){super(t),this.name="IdlError"}}class dr{constructor(t){this.stack=t}static parse(t){var e;const n=/^Program (\w*) invoke/,r=/^Program \w* success/,i=[];for(let s=0;s<t.length;s++){if(r.exec(t[s])){i.pop();continue}const a=null===(e=n.exec(t[s]))||void 0===e?void 0:e[1];a&&i.push(new o(a))}return new dr(i)}}class hr extends Error{constructor(t,e,n,r,o,i){super(n.join("\n").replace("Program log: ","")),this.errorLogs=n,this.logs=r,this.error={errorCode:t,errorMessage:e,comparedValues:i,origin:o},this._programErrorStack=dr.parse(r)}static parse(t){if(!t)return null;const e=t.findIndex(t=>t.startsWith("Program log: AnchorError"));if(-1===e)return null;const n=t[e],r=[n];let i;if(e+1<t.length)if("Program log: Left:"===t[e+1]){const n=/^Program log: (.*)$/,s=n.exec(t[e+2])[1],a=n.exec(t[e+4])[1];i=[new o(s),new o(a)],r.push(...t.slice(e+1,e+5))}else if(t[e+1].startsWith("Program log: Left:")){const n=/^Program log: (Left|Right): (.*)$/,o=n.exec(t[e+1])[2],s=n.exec(t[e+2])[2];r.push(...t.slice(e+1,e+3)),i=[o,s]}const s=/^Program log: AnchorError occurred\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n),a=/^Program log: AnchorError thrown in (.*):(\d*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n),c=/^Program log: AnchorError caused by account: (.*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n);if(s){const[e,n,o]=s.slice(1,4),a={code:e,number:parseInt(n)};return new hr(a,o,r,t,void 0,i)}if(a){const[e,n,o,s,c]=a.slice(1,6),u={code:o,number:parseInt(s)},l={file:e,line:parseInt(n)};return new hr(u,c,r,t,l,i)}if(c){const[e,n,o,s]=c.slice(1,5),a=e,u={code:n,number:parseInt(o)};return new hr(u,s,r,t,a,i)}return null}get program(){return this._programErrorStack.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){return this._programErrorStack.stack}toString(){return this.message}}class fr extends Error{constructor(t,e,n){super(),this.code=t,this.msg=e,this.logs=n,n&&(this._programErrorStack=dr.parse(n))}static parse(t,e){const n=t.toString();let r,o;if(n.includes("custom program error:")){let t=n.split("custom program error: ");if(2!==t.length)return null;r=t[1]}else{const t=n.match(/"Custom":([0-9]+)}/g);if(!t||t.length>1)return null;r=t[0].match(/([0-9]+)/g)[0]}try{o=parseInt(r)}catch(s){return null}let i=e.get(o);return void 0!==i?new fr(o,i,t.logs):(i=yr.get(o),void 0!==i?new fr(o,i,t.logs):null)}get program(){var t;return null===(t=this._programErrorStack)||void 0===t?void 0:t.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){var t;return null===(t=this._programErrorStack)||void 0===t?void 0:t.stack}toString(){return this.msg}}function pr(t,e){ur("debug-logs")&&console.log("Translating error:",t);const n=hr.parse(t.logs);if(n)return n;const r=fr.parse(t,e);if(r)return r;if(t.logs){const e={get:function(e,n){return"programErrorStack"===n?e.programErrorStack.stack:"program"===n?e.programErrorStack.stack[t.programErrorStack.stack.length-1]:Reflect.get(...arguments)}};return t.programErrorStack=dr.parse(t.logs),new Proxy(t,e)}return t}const _r={InstructionMissing:Ge,InstructionFallbackNotFound:Ve,InstructionDidNotDeserialize:je,InstructionDidNotSerialize:ze,IdlInstructionStub:Ke,IdlInstructionInvalidProgram:Fe,IdlAccountNotEmpty:$e,EventInstructionStub:qe,ConstraintMut:Ze,ConstraintHasOne:We,ConstraintSigner:Xe,ConstraintRaw:Ye,ConstraintOwner:Qe,ConstraintRentExempt:Je,ConstraintSeeds:tn,ConstraintExecutable:en,ConstraintState:nn,ConstraintAssociated:rn,ConstraintAssociatedInit:on,ConstraintClose:sn,ConstraintAddress:an,ConstraintZero:cn,ConstraintTokenMint:un,ConstraintTokenOwner:ln,ConstraintMintMintAuthority:dn,ConstraintMintFreezeAuthority:hn,ConstraintMintDecimals:fn,ConstraintSpace:pn,ConstraintAccountIsNone:_n,ConstraintTokenTokenProgram:yn,ConstraintMintTokenProgram:mn,ConstraintAssociatedTokenTokenProgram:gn,ConstraintMintGroupPointerExtension:wn,ConstraintMintGroupPointerExtensionAuthority:Rn,ConstraintMintGroupPointerExtensionGroupAddress:En,ConstraintMintGroupMemberPointerExtension:An,ConstraintMintGroupMemberPointerExtensionAuthority:vn,ConstraintMintGroupMemberPointerExtensionMemberAddress:On,ConstraintMintMetadataPointerExtension:Tn,ConstraintMintMetadataPointerExtensionAuthority:Nn,ConstraintMintMetadataPointerExtensionMetadataAddress:bn,ConstraintMintCloseAuthorityExtension:In,ConstraintMintCloseAuthorityExtensionAuthority:Cn,ConstraintMintPermanentDelegateExtension:Sn,ConstraintMintPermanentDelegateExtensionDelegate:xn,ConstraintMintTransferHookExtension:kn,ConstraintMintTransferHookExtensionAuthority:Dn,ConstraintMintTransferHookExtensionProgramId:Mn,RequireViolated:Pn,RequireEqViolated:He,RequireKeysEqViolated:Ln,RequireNeqViolated:Un,RequireKeysNeqViolated:Hn,RequireGtViolated:Bn,RequireGteViolated:Gn,AccountDiscriminatorAlreadySet:Vn,AccountDiscriminatorNotFound:jn,AccountDiscriminatorMismatch:zn,AccountDidNotDeserialize:Kn,AccountDidNotSerialize:Fn,AccountNotEnoughKeys:$n,AccountNotMutable:qn,AccountOwnedByWrongProgram:Zn,InvalidProgramId:Wn,InvalidProgramExecutable:Xn,AccountNotSigner:Yn,AccountNotSystemOwned:Qn,AccountNotInitialized:Jn,AccountNotProgramData:tr,AccountNotAssociatedTokenAccount:er,AccountSysvarMismatch:nr,AccountReallocExceedsLimit:rr,AccountDuplicateReallocs:or,DeclaredProgramIdMismatch:ir,TryingToInitPayerAsProgramAccount:sr,InvalidNumericConversion:ar,Deprecated:Be},yr=new Map([[_r.InstructionMissing,"Instruction discriminator not provided"],[_r.InstructionFallbackNotFound,"Fallback functions are not supported"],[_r.InstructionDidNotDeserialize,"The program could not deserialize the given instruction"],[_r.InstructionDidNotSerialize,"The program could not serialize the given instruction"],[_r.IdlInstructionStub,"The program was compiled without idl instructions"],[_r.IdlInstructionInvalidProgram,"The transaction was given an invalid program for the IDL instruction"],[_r.IdlAccountNotEmpty,"IDL account must be empty in order to resize, try closing first"],[_r.EventInstructionStub,"The program was compiled without `event-cpi` feature"],[_r.ConstraintMut,"A mut constraint was violated"],[_r.ConstraintHasOne,"A has one constraint was violated"],[_r.ConstraintSigner,"A signer constraint was violated"],[_r.ConstraintRaw,"A raw constraint was violated"],[_r.ConstraintOwner,"An owner constraint was violated"],[_r.ConstraintRentExempt,"A rent exemption constraint was violated"],[_r.ConstraintSeeds,"A seeds constraint was violated"],[_r.ConstraintExecutable,"An executable constraint was violated"],[_r.ConstraintState,"Deprecated Error, feel free to replace with something else"],[_r.ConstraintAssociated,"An associated constraint was violated"],[_r.ConstraintAssociatedInit,"An associated init constraint was violated"],[_r.ConstraintClose,"A close constraint was violated"],[_r.ConstraintAddress,"An address constraint was violated"],[_r.ConstraintZero,"Expected zero account discriminant"],[_r.ConstraintTokenMint,"A token mint constraint was violated"],[_r.ConstraintTokenOwner,"A token owner constraint was violated"],[_r.ConstraintMintMintAuthority,"A mint mint authority constraint was violated"],[_r.ConstraintMintFreezeAuthority,"A mint freeze authority constraint was violated"],[_r.ConstraintMintDecimals,"A mint decimals constraint was violated"],[_r.ConstraintSpace,"A space constraint was violated"],[_r.ConstraintAccountIsNone,"A required account for the constraint is None"],[_r.ConstraintTokenTokenProgram,"A token account token program constraint was violated"],[_r.ConstraintMintTokenProgram,"A mint token program constraint was violated"],[_r.ConstraintAssociatedTokenTokenProgram,"An associated token account token program constraint was violated"],[_r.ConstraintMintGroupPointerExtension,"A group pointer extension constraint was violated"],[_r.ConstraintMintGroupPointerExtensionAuthority,"A group pointer extension authority constraint was violated"],[_r.ConstraintMintGroupPointerExtensionGroupAddress,"A group pointer extension group address constraint was violated"],[_r.ConstraintMintGroupMemberPointerExtension,"A group member pointer extension constraint was violated"],[_r.ConstraintMintGroupMemberPointerExtensionAuthority,"A group member pointer extension authority constraint was violated"],[_r.ConstraintMintGroupMemberPointerExtensionMemberAddress,"A group member pointer extension group address constraint was violated"],[_r.ConstraintMintMetadataPointerExtension,"A metadata pointer extension constraint was violated"],[_r.ConstraintMintMetadataPointerExtensionAuthority,"A metadata pointer extension authority constraint was violated"],[_r.ConstraintMintMetadataPointerExtensionMetadataAddress,"A metadata pointer extension metadata address constraint was violated"],[_r.ConstraintMintCloseAuthorityExtension,"A close authority constraint was violated"],[_r.ConstraintMintCloseAuthorityExtensionAuthority,"A close authority extension authority constraint was violated"],[_r.ConstraintMintPermanentDelegateExtension,"A permanent delegate extension constraint was violated"],[_r.ConstraintMintPermanentDelegateExtensionDelegate,"A permanent delegate extension delegate constraint was violated"],[_r.ConstraintMintTransferHookExtension,"A transfer hook extension constraint was violated"],[_r.ConstraintMintTransferHookExtensionAuthority,"A transfer hook extension authority constraint was violated"],[_r.ConstraintMintTransferHookExtensionProgramId,"A transfer hook extension transfer hook program id constraint was violated"],[_r.RequireViolated,"A require expression was violated"],[_r.RequireEqViolated,"A require_eq expression was violated"],[_r.RequireKeysEqViolated,"A require_keys_eq expression was violated"],[_r.RequireNeqViolated,"A require_neq expression was violated"],[_r.RequireKeysNeqViolated,"A require_keys_neq expression was violated"],[_r.RequireGtViolated,"A require_gt expression was violated"],[_r.RequireGteViolated,"A require_gte expression was violated"],[_r.AccountDiscriminatorAlreadySet,"The account discriminator was already set on this account"],[_r.AccountDiscriminatorNotFound,"No discriminator was found on the account"],[_r.AccountDiscriminatorMismatch,"Account discriminator did not match what was expected"],[_r.AccountDidNotDeserialize,"Failed to deserialize the account"],[_r.AccountDidNotSerialize,"Failed to serialize the account"],[_r.AccountNotEnoughKeys,"Not enough account keys given to the instruction"],[_r.AccountNotMutable,"The given account is not mutable"],[_r.AccountOwnedByWrongProgram,"The given account is owned by a different program than expected"],[_r.InvalidProgramId,"Program ID was not as expected"],[_r.InvalidProgramExecutable,"Program account is not executable"],[_r.AccountNotSigner,"The given account did not sign"],[_r.AccountNotSystemOwned,"The given account is not owned by the system program"],[_r.AccountNotInitialized,"The program expected this account to be already initialized"],[_r.AccountNotProgramData,"The given account is not a program data account"],[_r.AccountNotAssociatedTokenAccount,"The given account is not the associated token account"],[_r.AccountSysvarMismatch,"The given public key does not match the required sysvar"],[_r.AccountReallocExceedsLimit,"The account reallocation exceeds the MAX_PERMITTED_DATA_INCREASE limit"],[_r.AccountDuplicateReallocs,"The account was duplicated for more than one reallocation"],[_r.DeclaredProgramIdMismatch,"The declared program id does not match the actual program id"],[_r.TryingToInitPayerAsProgramAccount,"You cannot/should not initialize the payer account as a program account"],[_r.InvalidNumericConversion,"The program could not perform the numeric conversion, out of range integral type conversion attempted"],[_r.Deprecated,"The API being used is deprecated and should no longer be used"]]);class mr{static fieldLayout(t,e=[],n){const r=t.name;switch(t.type){case"bool":return C.bool(r);case"u8":return C.u8(r);case"i8":return C.i8(r);case"u16":return C.u16(r);case"i16":return C.i16(r);case"u32":return C.u32(r);case"i32":return C.i32(r);case"f32":return C.f32(r);case"u64":return C.u64(r);case"i64":return C.i64(r);case"f64":return C.f64(r);case"u128":return C.u128(r);case"i128":return C.i128(r);case"u256":return C.u256(r);case"i256":return C.i256(r);case"bytes":return C.vecU8(r);case"string":return C.str(r);case"pubkey":return C.publicKey(r);default:if("option"in t.type)return C.option(mr.fieldLayout({type:t.type.option},e,n),r);if("vec"in t.type)return C.vec(mr.fieldLayout({type:t.type.vec},e,n),r);if("array"in t.type){let[o,i]=t.type.array;return i=mr.resolveArrayLen(i,n),C.array(mr.fieldLayout({type:o},e,n),i,r)}if("defined"in t.type){if(!e)throw new lr("User defined types not provided");const o=t.type.defined.name,i=e.find(t=>t.name===o);if(!i)throw new lr(`Type not found: ${t.name}`);return mr.typeDefLayout({typeDef:i,types:e,genericArgs:null!=n?n:t.type.defined.generics,name:r})}if("generic"in t.type){const r=null==n?void 0:n.at(0);if("type"!==(null==r?void 0:r.kind))throw new lr(`Invalid generic field: ${t.name}`);return mr.fieldLayout({...t,type:r.type},e)}throw new lr(`Not yet implemented: ${JSON.stringify(t.type)}`)}}static typeDefLayout({typeDef:t,types:e,name:n,genericArgs:r}){switch(t.type.kind){case"struct":{const o=te(t.type.fields,()=>[],n=>n.map(n=>{const o=r?mr.resolveGenericArgs({type:n.type,typeDef:t,genericArgs:r}):r;return mr.fieldLayout(n,e,o)}),n=>n.map((n,o)=>{const i=r?mr.resolveGenericArgs({type:n,typeDef:t,genericArgs:r}):r;return mr.fieldLayout({name:o.toString(),type:n},e,i)}));return C.struct(o,n)}case"enum":{const o=t.type.variants.map(n=>{const o=te(n.fields,()=>[],n=>n.map(n=>{const o=r?mr.resolveGenericArgs({type:n.type,typeDef:t,genericArgs:r}):r;return mr.fieldLayout(n,e,o)}),n=>n.map((n,o)=>{const i=r?mr.resolveGenericArgs({type:n,typeDef:t,genericArgs:r}):r;return mr.fieldLayout({name:o.toString(),type:n},e,i)}));return C.struct(o,n.name)});return void 0!==n?C.rustEnum(o).replicate(n):C.rustEnum(o,n)}case"type":return mr.fieldLayout({type:t.type.alias,name:n},e)}}static typeSize(t,e,n){var r;switch(t){case"bool":case"u8":case"i8":case"bytes":case"string":return 1;case"i16":case"u16":return 2;case"u32":case"i32":case"f32":return 4;case"u64":case"i64":case"f64":return 8;case"u128":case"i128":return 16;case"u256":case"i256":case"pubkey":return 32;default:if("option"in t)return 1+mr.typeSize(t.option,e,n);if("coption"in t)return 4+mr.typeSize(t.coption,e,n);if("vec"in t)return 1;if("array"in t){let[r,o]=t.array;return o=mr.resolveArrayLen(o,n),mr.typeSize(r,e,n)*o}if("defined"in t){const o=null===(r=e.types)||void 0===r?void 0:r.find(e=>e.name===t.defined.name);if(!o)throw new lr(`Type not found: ${JSON.stringify(t)}`);const i=r=>{const i=null!=n?n:t.defined.generics,s=i?mr.resolveGenericArgs({type:r,typeDef:o,genericArgs:i}):i;return mr.typeSize(r,e,s)};switch(o.type.kind){case"struct":return te(o.type.fields,()=>[0],t=>t.map(t=>i(t.type)),t=>t.map(t=>i(t))).reduce((t,e)=>t+e,0);case"enum":{const t=o.type.variants.map(t=>te(t.fields,()=>[0],t=>t.map(t=>i(t.type)),t=>t.map(t=>i(t))).reduce((t,e)=>t+e,0));return Math.max(...t)+1}case"type":return mr.typeSize(o.type.alias,e,n)}}if("generic"in t){const r=null==n?void 0:n.at(0);if("type"!==(null==r?void 0:r.kind))throw new lr(`Invalid generic: ${t.generic}`);return mr.typeSize(r.type,e,n)}throw new Error(`Invalid type ${JSON.stringify(t)}`)}}static resolveArrayLen(t,e){if("number"==typeof t)return t;if(e){const n=e.find(t=>"const"===t.kind);"const"===(null==n?void 0:n.kind)&&(t=+n.value)}if("number"!=typeof t)throw new lr("Generic array length did not resolve");return t}static resolveGenericArgs({type:t,typeDef:e,genericArgs:n,isDefined:r}){if("object"!=typeof t)return null;for(const o in e.generics){const i=e.generics[o];if("generic"in t&&i.name===t.generic)return[n[o]];if("option"in t){const o=mr.resolveGenericArgs({type:t.option,typeDef:e,genericArgs:n,isDefined:r});if(!o||!r)return o;if("type"===o[0].kind)return[{kind:"type",type:{option:o[0].type}}]}if("vec"in t){const o=mr.resolveGenericArgs({type:t.vec,typeDef:e,genericArgs:n,isDefined:r});if(!o||!r)return o;if("type"===o[0].kind)return[{kind:"type",type:{vec:o[0].type}}]}if("array"in t){const[s,a]=t.array,c="object"==typeof a,u=mr.resolveGenericArgs({type:s,typeDef:e,genericArgs:n,isDefined:r})||[];if(c){const t=e.generics.findIndex(t=>t.name===a.generic);-1!==t&&u.push(n[t])}if(u.length>0){if(!r)return u;if("type"===u[0].kind&&"const"===u[1].kind)return[{kind:"type",type:{array:[u[0].type,+u[1].value]}}]}if(c&&i.name===a.generic){const t=n[o];return r?[{kind:"type",type:{array:[s,+t.value]}}]:[t]}return null}if("defined"in t)return t.defined.generics?t.defined.generics.flatMap(t=>{switch(t.kind){case"type":return mr.resolveGenericArgs({type:t.type,typeDef:e,genericArgs:n,isDefined:!0});case"const":return[t]}}).filter(t=>null!==t):null}return null}}class gr{constructor(t){this.idl=t;const e=t.instructions.map(e=>{const n=e.name,r=e.args.map(e=>mr.fieldLayout(e,t.types)),o=C.struct(r,n);return[n,{discriminator:e.discriminator,layout:o}]});this.ixLayouts=new Map(e)}encode(t,e){const n=i.Buffer.alloc(1e3),r=this.ixLayouts.get(t);if(!r)throw new Error(`Unknown method: ${t}`);const o=r.layout.encode(e,n),s=n.slice(0,o);return i.Buffer.concat([i.Buffer.from(r.discriminator),s])}decode(t,e="hex"){"string"==typeof t&&(t="hex"===e?i.Buffer.from(t,"hex"):r.decode(t));for(const[n,r]of this.ixLayouts){const e=t.subarray(0,r.discriminator.length);if(e.equals(i.Buffer.from(r.discriminator)))return{name:n,data:r.layout.decode(t.subarray(e.length))}}return null}format(t,e){return wr.format(t,e,this.idl)}}class wr{static format(t,e,n){const r=n.instructions.find(e=>t.name===e.name);if(!r)return console.error("Invalid instruction given"),null;const o=r.args.map(e=>({name:e.name,type:wr.formatIdlType(e.type),data:wr.formatIdlData(e,t.data[e.name],n.types)})),i=wr.flattenIdlAccounts(r.accounts);return{args:o,accounts:e.map((t,e)=>e<i.length?{name:i[e].name,...t}:{name:void 0,...t})}}static formatIdlType(t){if("string"==typeof t)return t;if("option"in t)return`Option<${this.formatIdlType(t.option)}>`;if("coption"in t)return`COption<${this.formatIdlType(t.coption)}>`;if("vec"in t)return`Vec<${this.formatIdlType(t.vec)}>`;if("array"in t)return`Array<${t.array[0]}; ${t.array[1]}>`;if("defined"in t){const e=t.defined.name;if(t.defined.generics){return`${e}<${t.defined.generics.map(t=>{switch(t.kind){case"type":return wr.formatIdlType(t.type);case"const":return t.value}}).join(", ")}>`}return e}throw new Error(`Unknown IDL type: ${t}`)}static formatIdlData(t,e,n){if("string"==typeof t.type)return e.toString();if("vec"in t.type)return"["+e.map(e=>this.formatIdlData({name:"",type:t.type.vec},e,n)).join(", ")+"]";if("option"in t.type)return null===e?"null":this.formatIdlData({name:"",type:t.type.option},e,n);if("defined"in t.type){if(!n)throw new Error("User defined types not provided");const r=t.type.defined.name,o=n.find(t=>t.name===r);if(!o)throw new Error(`Type not found: ${r}`);return wr.formatIdlDataDefined(o,e,n)}return"unknown"}static formatIdlDataDefined(t,e,n){switch(t.type.kind){case"struct":return"{ "+te(t.type.fields,()=>"",t=>Object.entries(e).map(([e,r])=>{const o=t.find(t=>t.name===e);if(!o)throw new Error(`Field not found: ${e}`);return e+": "+wr.formatIdlData(o,r,n)}).join(", "),t=>Object.entries(e).map(([e,r])=>e+": "+wr.formatIdlData({name:"",type:t[e]},r,n)).join(", "))+" }";case"enum":{const r=Object.keys(e)[0],o=t.type.variants.find(t=>t.name===r);if(!o)throw new Error(`Unable to find variant: ${r}`);const i=e[r];return te(o.fields,()=>r,t=>{const e=Object.keys(i).map(e=>{const r=i[e],o=t.find(t=>t.name===e);if(!o)throw new Error(`Field not found: ${e}`);return e+": "+wr.formatIdlData(o,r,n)}).join(", ");return`${r} { ${e} }`},t=>{const e=Object.entries(i).map(([e,r])=>e+": "+wr.formatIdlData({name:"",type:t[e]},r,n)).join(", ");return`${r} { ${e} }`})}case"type":return wr.formatIdlType(t.type.alias)}}static flattenIdlAccounts(t,e){return t.map(t=>{const n=function(t){const e=t.replace(/([A-Z])/g," $1");return e.charAt(0).toUpperCase()+e.slice(1)}(t.name);if(t.hasOwnProperty("accounts")){const r=e?`${e} > ${n}`:n;return wr.flattenIdlAccounts(t.accounts,r)}return{...t,name:e?`${e} > ${n}`:n}}).flat()}}class Rr{constructor(t){if(this.idl=t,!t.accounts)return void(this.accountLayouts=new Map);const e=t.types;if(!e)throw new Error("Accounts require `idl.types`");const n=t.accounts.map(t=>{const n=e.find(e=>e.name===t.name);if(!n)throw new Error(`Account not found: ${t.name}`);return[t.name,{discriminator:t.discriminator,layout:mr.typeDefLayout({typeDef:n,types:e})}]});this.accountLayouts=new Map(n)}async encode(t,e){const n=i.Buffer.alloc(1e3),r=this.accountLayouts.get(t);if(!r)throw new Error(`Unknown account: ${t}`);const o=r.layout.encode(e,n),s=n.slice(0,o),a=this.accountDiscriminator(t);return i.Buffer.concat([a,s])}decode(t,e){const n=this.accountDiscriminator(t);if(n.compare(e.slice(0,n.length)))throw new Error("Invalid account discriminator");return this.decodeUnchecked(t,e)}decodeAny(t){for(const[e,n]of this.accountLayouts){if(t.subarray(0,n.discriminator.length).equals(i.Buffer.from(n.discriminator)))return this.decodeUnchecked(e,t)}throw new Error("Account not found")}decodeUnchecked(t,e){const n=this.accountDiscriminator(t),r=e.subarray(n.length),o=this.accountLayouts.get(t);if(!o)throw new Error(`Unknown account: ${t}`);return o.layout.decode(r)}memcmp(t,e){const n=this.accountDiscriminator(t);return{offset:0,bytes:r.encode(e?i.Buffer.concat([n,e]):n)}}size(t){return this.accountDiscriminator(t).length+mr.typeSize({defined:{name:t}},this.idl)}accountDiscriminator(t){var e;const n=null===(e=this.idl.accounts)||void 0===e?void 0:e.find(e=>e.name===t);if(!n)throw new Error(`Account not found: ${t}`);return i.Buffer.from(n.discriminator)}}class Er{constructor(t){if(!t.events)return void(this.layouts=new Map);const e=t.types;if(!e)throw new Error("Events require `idl.types`");const n=t.events.map(t=>{const n=e.find(e=>e.name===t.name);if(!n)throw new Error(`Event not found: ${t.name}`);return[t.name,{discriminator:t.discriminator,layout:mr.typeDefLayout({typeDef:n,types:e})}]});this.layouts=new Map(n)}decode(t){let e;try{e=Yt(t)}catch(n){return null}for(const[r,o]of this.layouts){const t=e.subarray(0,o.discriminator.length);if(t.equals(i.Buffer.from(o.discriminator)))return{name:r,data:o.layout.decode(e.subarray(t.length))}}return null}}class Ar{constructor(t){const e=t.types;if(!e)return void(this.typeLayouts=new Map);const n=e.filter(t=>!t.generics).map(t=>[t.name,mr.typeDefLayout({typeDef:t,types:e})]);this.typeLayouts=new Map(n)}encode(t,e){const n=i.Buffer.alloc(1e3),r=this.typeLayouts.get(t);if(!r)throw new Error(`Unknown type: ${t}`);const o=r.encode(e,n);return n.slice(0,o)}decode(t,e){const n=this.typeLayouts.get(t);if(!n)throw new Error(`Unknown type: ${t}`);return n.decode(e)}}class vr{constructor(t){this.instruction=new gr(t),this.accounts=new Rr(t),this.events=new Er(t),this.types=new Ar(t)}}class Or{constructor(t,e){if(!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=e}makeDestinationObject(){return{}}decode(t,e){throw new Error("Layout is abstract")}encode(t,e,n){throw new Error("Layout is abstract")}getSpan(t,e){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(t){const e=Object.create(this.constructor.prototype);return Object.assign(e,this),e.property=t,e}fromArray(t){}}var Tr=Or;class Nr extends Or{isCount(){throw new Error("ExternalLayout is abstract")}}class br extends Nr{constructor(t,e,n){if(!(t instanceof Or))throw new TypeError("layout must be a Layout");if(void 0===e)e=0;else if(!Number.isInteger(e))throw new TypeError("offset must be integer or undefined");super(t.span,n||t.property),this.layout=t,this.offset=e}isCount(){return this.layout instanceof Ir||this.layout instanceof Cr}decode(t,e){return void 0===e&&(e=0),this.layout.decode(t,e+this.offset)}encode(t,e,n){return void 0===n&&(n=0),this.layout.encode(t,e,n+this.offset)}}class Ir extends Or{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e){return void 0===e&&(e=0),t.readUIntLE(e,this.span)}encode(t,e,n){return void 0===n&&(n=0),e.writeUIntLE(t,n,this.span),this.span}}class Cr extends Or{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e){return void 0===e&&(e=0),t.readUIntBE(e,this.span)}encode(t,e,n){return void 0===n&&(n=0),e.writeUIntBE(t,n,this.span),this.span}}const Sr=Math.pow(2,32);function xr(t){const e=Math.floor(t/Sr);return{hi32:e,lo32:t-e*Sr}}function kr(t,e){return t*Sr+e}class Dr extends Or{constructor(t){super(8,t)}decode(t,e){void 0===e&&(e=0);const n=t.readUInt32LE(e);return kr(t.readUInt32LE(e+4),n)}encode(t,e,n){void 0===n&&(n=0);const r=xr(t);return e.writeUInt32LE(r.lo32,n),e.writeUInt32LE(r.hi32,n+4),8}}class Mr extends Or{constructor(t){super(8,t)}decode(t,e){void 0===e&&(e=0);const n=t.readUInt32LE(e);return kr(t.readInt32LE(e+4),n)}encode(t,e,n){void 0===n&&(n=0);const r=xr(t);return e.writeUInt32LE(r.lo32,n),e.writeInt32LE(r.hi32,n+4),8}}class Pr extends Or{constructor(t,e,n){if(!Array.isArray(t)||!t.reduce((t,e)=>t&&e instanceof Or,!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof e&&void 0===n&&(n=e,e=void 0);for(const i of t)if(0>i.span&&void 0===i.property)throw new Error("fields cannot contain unnamed variable-length layout");let r=-1;try{r=t.reduce((t,e)=>t+e.getSpan(),0)}catch(o){}super(r,e),this.fields=t,this.decodePrefixes=!!n}getSpan(t,e){if(0<=this.span)return this.span;void 0===e&&(e=0);let n=0;try{n=this.fields.reduce((n,r)=>{const o=r.getSpan(t,e);return e+=o,n+o},0)}catch(r){throw new RangeError("indeterminate span")}return n}decode(t,e){void 0===e&&(e=0);const n=this.makeDestinationObject();for(const r of this.fields)if(void 0!==r.property&&(n[r.property]=r.decode(t,e)),e+=r.getSpan(t,e),this.decodePrefixes&&t.length===e)break;return n}encode(t,e,n){void 0===n&&(n=0);const r=n;let o=0,i=0;for(const s of this.fields){let r=s.span;if(i=0<r?r:0,void 0!==s.property){const o=t[s.property];void 0!==o&&(i=s.encode(o,e,n),0>r&&(r=s.getSpan(e,n)))}o=n,n+=r}return o+i-r}fromArray(t){const e=this.makeDestinationObject();for(const n of this.fields)void 0!==n.property&&0<t.length&&(e[n.property]=t.shift());return e}layoutFor(t){if("string"!=typeof t)throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}offsetOf(t){if("string"!=typeof t)throw new TypeError("property must be string");let e=0;for(const n of this.fields){if(n.property===t)return e;0>n.span?e=-1:0<=e&&(e+=n.span)}}}class Lr{constructor(t){this.property=t}decode(){throw new Error("UnionDiscriminator is abstract")}encode(){throw new Error("UnionDiscriminator is abstract")}}class Ur extends Lr{constructor(t,e){if(!(t instanceof Nr&&t.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(e||t.property||"variant"),this.layout=t}decode(t,e){return this.layout.decode(t,e)}encode(t,e,n){return this.layout.encode(t,e,n)}}class Hr extends Or{constructor(t,e,n){const r=t instanceof Ir||t instanceof Cr;if(r)t=new Ur(new br(t));else if(t instanceof Nr&&t.isCount())t=new Ur(t);else if(!(t instanceof Lr))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(void 0===e&&(e=null),!(null===e||e instanceof Or))throw new TypeError("defaultLayout must be null or a Layout");if(null!==e){if(0>e.span)throw new Error("defaultLayout must have constant span");void 0===e.property&&(e=e.replicate("content"))}let o=-1;e&&(o=e.span,0<=o&&r&&(o+=t.layout.span)),super(o,n),this.discriminator=t,this.usesPrefixDiscriminator=r,this.defaultLayout=e,this.registry={};let i=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(t){return i(t)},this.configGetSourceVariant=function(t){i=t.bind(this)}}getSpan(t,e){if(0<=this.span)return this.span;void 0===e&&(e=0);const n=this.getVariant(t,e);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(t,e)}defaultGetSourceVariant(t){if(t.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&t.hasOwnProperty(this.defaultLayout.property))return;const e=this.registry[t[this.discriminator.property]];if(e&&(!e.layout||t.hasOwnProperty(e.property)))return e}else for(const e in this.registry){const n=this.registry[e];if(t.hasOwnProperty(n.property))return n}throw new Error("unable to infer src variant")}decode(t,e){let n;void 0===e&&(e=0);const r=this.discriminator,o=r.decode(t,e);let i=this.registry[o];if(void 0===i){let s=0;i=this.defaultLayout,this.usesPrefixDiscriminator&&(s=r.layout.span),n=this.makeDestinationObject(),n[r.property]=o,n[i.property]=this.defaultLayout.decode(t,e+s)}else n=i.decode(t,e);return n}encode(t,e,n){void 0===n&&(n=0);const r=this.getSourceVariant(t);if(void 0===r){const r=this.discriminator,o=this.defaultLayout;let i=0;return this.usesPrefixDiscriminator&&(i=r.layout.span),r.encode(t[r.property],e,n),i+o.encode(t[o.property],e,n+i)}return r.encode(t,e,n)}addVariant(t,e,n){const r=new Br(this,t,e,n);return this.registry[t]=r,r}getVariant(t,e){let n=t;return Buffer.isBuffer(t)&&(void 0===e&&(e=0),n=this.discriminator.decode(t,e)),this.registry[n]}}class Br extends Or{constructor(t,e,n,r){if(!(t instanceof Hr))throw new TypeError("union must be a Union");if(!Number.isInteger(e)||0>e)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof n&&void 0===r&&(r=n,n=null),n){if(!(n instanceof Or))throw new TypeError("layout must be a Layout");if(null!==t.defaultLayout&&0<=n.span&&n.span>t.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof r)throw new TypeError("variant must have a String property")}let o=t.span;0>t.span&&(o=n?n.span:0,0<=o&&t.usesPrefixDiscriminator&&(o+=t.discriminator.layout.span)),super(o,r),this.union=t,this.variant=e,this.layout=n||null}getSpan(t,e){if(0<=this.span)return this.span;void 0===e&&(e=0);let n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),n+this.layout.getSpan(t,e+n)}decode(t,e){const n=this.makeDestinationObject();if(void 0===e&&(e=0),this!==this.union.getVariant(t,e))throw new Error("variant mismatch");let r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(t,e+r):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(t,e,n){void 0===n&&(n=0);let r=0;if(this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout&&!t.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,e,n);let o=r;if(this.layout&&(this.layout.encode(t[this.property],e,n+r),o+=this.layout.getSpan(e,n+r),0<=this.union.span&&o>this.union.span))throw new Error("encoded variant overruns containing union");return o}fromArray(t){if(this.layout)return this.layout.fromArray(t)}}class Gr extends Or{constructor(t,e){if(!(t instanceof Nr&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;t instanceof Nr||(n=t),super(n,e),this.length=t}getSpan(t,e){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),n}decode(t,e){void 0===e&&(e=0);let n=this.span;return 0>n&&(n=this.length.decode(t,e)),t.slice(e,e+n)}encode(t,e,n){let r=this.length;if(this.length instanceof Nr&&(r=t.length),!Buffer.isBuffer(t)||r!==t.length)throw new TypeError((o="Blob.encode",((i=this).property?o+"["+i.property+"]":o)+" requires (length "+r+") Buffer as src"));var o,i;if(n+r>e.length)throw new RangeError("encoding overruns Buffer");return e.write(t.toString("hex"),n,r,"hex"),this.length instanceof Nr&&this.length.encode(r,e,n),r}}var Vr=(t,e,n)=>new br(t,e,n),jr=t=>new Ir(4,t),zr=t=>new Mr(t),Kr=(t,e,n)=>new Pr(t,e,n),Fr=(t,e,n)=>new Hr(t,e,n),$r=(t,e)=>new Gr(t,e);class qr extends Tr{constructor(t){super(-1,t),this.property=t,this.layout=Kr([jr("length"),jr("lengthPadding"),$r(Vr(jr(),-8),"chars")],this.property)}encode(t,e,n=0){if(null==t)return this.layout.span;const r={chars:Buffer.from(t,"utf8")};return this.layout.encode(r,e,n)}decode(t,e=0){return this.layout.decode(t,e).chars.toString()}getSpan(t,e=0){return jr().span+jr().span+new u(new Uint8Array(t).slice(e,e+4),10,"le").toNumber()}}function Zr(t){return new qr(t)}function Wr(t){return $r(32,t)}const Xr=Fr(jr("instruction"));Xr.addVariant(0,Kr([zr("lamports"),zr("space"),Wr("owner")]),"createAccount"),Xr.addVariant(1,Kr([Wr("owner")]),"assign"),Xr.addVariant(2,Kr([zr("lamports")]),"transfer"),Xr.addVariant(3,Kr([Wr("base"),Zr("seed"),zr("lamports"),zr("space"),Wr("owner")]),"createAccountWithSeed"),Xr.addVariant(4,Kr([Wr("authorized")]),"advanceNonceAccount"),Xr.addVariant(5,Kr([zr("lamports")]),"withdrawNonceAccount"),Xr.addVariant(6,Kr([Wr("authorized")]),"initializeNonceAccount"),Xr.addVariant(7,Kr([Wr("authorized")]),"authorizeNonceAccount"),Xr.addVariant(8,Kr([zr("space")]),"allocate"),Xr.addVariant(9,Kr([Wr("base"),Zr("seed"),zr("space"),Wr("owner")]),"allocateWithSeed"),Xr.addVariant(10,Kr([Wr("base"),Zr("seed"),Wr("owner")]),"assignWithSeed"),Xr.addVariant(11,Kr([zr("lamports"),Zr("seed"),Wr("owner")]),"transferWithSeed"),Math.max(...Object.values(Xr.registry).map(t=>t.span));class Yr extends Tr{constructor(t,e,n,r){super(t.span,r),this.layout=t,this.decoder=e,this.encoder=n}decode(t,e){return this.decoder(this.layout.decode(t,e))}encode(t,e,n){return this.layout.encode(this.encoder(t),e,n)}getSpan(t,e){return this.layout.getSpan(t,e)}}function Qr(t){return new Yr($r(32),t=>new o(t),t=>t.toBuffer(),t)}var Jr;Kr([jr("version"),jr("state"),Qr("authorizedPubkey"),Qr("nonce"),Kr([(Jr="lamportsPerSignature",new Dr(Jr))],"feeCalculator")]),new o("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),new o("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");var to={exports:{}};!function(t,e){var n,r="undefined"!=typeof self?self:Le,o=function(){function t(){this.fetch=!1,this.DOMException=r.DOMException}return t.prototype=r,new t}();n=o,function(t){var e="URLSearchParams"in n,r="Symbol"in n&&"iterator"in Symbol,o="FileReader"in n&&"Blob"in n&&function(){try{return new Blob,!0}catch(t){return!1}}(),i="FormData"in n,s="ArrayBuffer"in n;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(t){return t&&a.indexOf(Object.prototype.toString.call(t))>-1};function u(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function l(t){return"string"!=typeof t&&(t=String(t)),t}function d(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return r&&(e[Symbol.iterator]=function(){return e}),e}function h(t){this.map={},t instanceof h?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function f(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function p(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function _(t){var e=new FileReader,n=p(e);return e.readAsArrayBuffer(t),n}function y(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(t){var n;this._bodyInit=t,t?"string"==typeof t?this._bodyText=t:o&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:i&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:e&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():s&&o&&(n=t)&&DataView.prototype.isPrototypeOf(n)?(this._bodyArrayBuffer=y(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(t)||c(t))?this._bodyArrayBuffer=y(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o&&(this.blob=function(){var t=f(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(_)}),this.text=function(){var t,e,n,r=f(this);if(r)return r;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,n=p(e),e.readAsText(t),n;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(R)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(t,e){t=u(t),e=l(e);var n=this.map[t];this.map[t]=n?n+", "+e:e},h.prototype.delete=function(t){delete this.map[u(t)]},h.prototype.get=function(t){return t=u(t),this.has(t)?this.map[t]:null},h.prototype.has=function(t){return this.map.hasOwnProperty(u(t))},h.prototype.set=function(t,e){this.map[u(t)]=l(e)},h.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},h.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),d(t)},h.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),d(t)},h.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),d(t)},r&&(h.prototype[Symbol.iterator]=h.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function w(t,e){var n,r,o=(e=e||{}).body;if(t instanceof w){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new h(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,o||null==t._bodyInit||(o=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new h(e.headers)),this.method=(n=e.method||this.method||"GET",r=n.toUpperCase(),g.indexOf(r)>-1?r:n),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function R(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}}),e}function E(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new h(e.headers),this.url=e.url||"",this._initBody(t)}w.prototype.clone=function(){return new w(this,{body:this._bodyInit})},m.call(w.prototype),m.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},E.error=function(){var t=new E(null,{status:0,statusText:""});return t.type="error",t};var A=[301,302,303,307,308];E.redirect=function(t,e){if(-1===A.indexOf(e))throw new RangeError("Invalid status code");return new E(null,{status:e,headers:{location:t}})},t.DOMException=n.DOMException;try{new t.DOMException}catch(O){t.DOMException=function(t,e){this.message=t,this.name=e;var n=Error(t);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function v(e,n){return new Promise(function(r,i){var s=new w(e,n);if(s.signal&&s.signal.aborted)return i(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var t,e,n={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new h,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();e.append(r,o)}}),e)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var o="response"in a?a.response:a.responseText;r(new E(o,n))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new t.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&o&&(a.responseType="blob"),s.headers.forEach(function(t,e){a.setRequestHeader(e,t)}),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(void 0===s._bodyInit?null:s._bodyInit)})}v.polyfill=!0,n.fetch||(n.fetch=v,n.Headers=h,n.Request=w,n.Response=E),t.Headers=h,t.Request=w,t.Response=E,t.fetch=v,Object.defineProperty(t,"__esModule",{value:!0})}({}),o.fetch.ponyfill=!0,delete o.fetch.polyfill;var i=o;(e=i.fetch).default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,t.exports=e}(to,to.exports),C.rustEnum([C.struct([],"uninitialized"),C.struct([C.option(C.publicKey(),"authorityAddress")],"buffer"),C.struct([C.publicKey("programdataAddress")],"program"),C.struct([C.u64("slot"),C.option(C.publicKey(),"upgradeAuthorityAddress")],"programData")],void 0,C.u32());const eo="Program log: ",no="Program data: ";class ro{constructor(t,e,n){this._programId=t,this._provider=e,this._eventParser=new oo(t,n),this._eventCallbacks=new Map,this._eventListeners=new Map,this._listenerIdCount=0}addEventListener(t,e,n){var r;let o=this._listenerIdCount;return this._listenerIdCount+=1,this._eventListeners.has(t)||this._eventListeners.set(t,[]),this._eventListeners.set(t,(null!==(r=this._eventListeners.get(t))&&void 0!==r?r:[]).concat(o)),this._eventCallbacks.set(o,[t,e]),void 0!==this._onLogsSubscriptionId||(this._onLogsSubscriptionId=this._provider.connection.onLogs(this._programId,(t,e)=>{if(!t.err)for(const n of this._eventParser.parseLogs(t.logs)){const r=this._eventListeners.get(n.name);r&&r.forEach(r=>{const o=this._eventCallbacks.get(r);if(o){const[,r]=o;r(n.data,e.slot,t.signature)}})}},n)),o}async removeEventListener(t){const e=this._eventCallbacks.get(t);if(!e)throw new Error(`Event listener ${t} doesn't exist!`);const[n]=e;let r=this._eventListeners.get(n);if(!r)throw new Error(`Event listeners don't exist for ${n}!`);if(this._eventCallbacks.delete(t),r=r.filter(e=>e!==t),this._eventListeners.set(n,r),0===r.length&&this._eventListeners.delete(n),0===this._eventCallbacks.size){if(0!==this._eventListeners.size)throw new Error(`Expected event listeners size to be 0 but got ${this._eventListeners.size}`);void 0!==this._onLogsSubscriptionId&&(await this._provider.connection.removeOnLogsListener(this._onLogsSubscriptionId),this._onLogsSubscriptionId=void 0)}}}class oo{constructor(t,e){this.coder=e,this.programId=t}*parseLogs(t,e=!1){const n=new so([...t]),r=new io,o=n.next();if(null===o)return;const i=oo.INVOKE_RE.exec(o);if(!i||i[2]!==oo.ROOT_DEPTH)throw new Error(`Unexpected first log line: ${o}`);for(r.push(i[1]);null!==n.peek();){const t=n.next();if(null===t)break;let[o,i,s]=this.handleLog(r,t,e);if(o&&(yield o),i&&r.push(i),s){r.pop();const t=n.peek();if(t&&t.endsWith("invoke [1]")){const e=oo.INVOKE_RE.exec(t);e&&r.push(e[1])}}}}handleLog(t,e,n){return t.stack.length>0&&t.program()===this.programId.toString()?this.handleProgramLog(e,n):[null,...this.handleSystemLog(e)]}handleProgramLog(t,e){if(t.startsWith(eo)||t.startsWith(no)){const n=t.startsWith(eo)?t.slice(13):t.slice(14),r=this.coder.events.decode(n);if(e&&null===r)throw new Error(`Unable to decode event ${n}`);return[r,null,!1]}return[null,...this.handleSystemLog(t)]}handleSystemLog(t){if(t.startsWith(`Program ${this.programId.toString()} log:`))return[this.programId.toString(),!1];if(t.includes("invoke")&&!t.endsWith("[1]"))return["cpi",!1];return/^Program ([1-9A-HJ-NP-Za-km-z]+) success$/.test(t)?[null,!0]:[null,!1]}}oo.INVOKE_RE=/^Program ([1-9A-HJ-NP-Za-km-z]+) invoke \[(\d+)\]$/,oo.ROOT_DEPTH="1";class io{constructor(){this.stack=[]}program(){if(!this.stack.length)throw new Error("Expected the stack to have elements");return this.stack[this.stack.length-1]}push(t){this.stack.push(t)}pop(){if(!this.stack.length)throw new Error("Expected the stack to have elements");this.stack.pop()}}class so{constructor(t){this.logs=t,this.logs=this.logs.filter(t=>t.startsWith("Program "))}next(){if(0===this.logs.length)return null;let t=this.logs[0];return this.logs=this.logs.slice(1),t}peek(){return this.logs.length>0?this.logs[0]:null}}function ao(t,e){var n,r;let o={};const i=t.args?t.args.length:0;if(e.length>i){if(e.length!==i+1)throw new Error(`provided too many arguments ${e} to instruction ${null==t?void 0:t.name} expecting: ${null!==(r=null===(n=t.args)||void 0===n?void 0:n.map(t=>t.name))&&void 0!==r?r:[]}`);o=e.pop()}return[e,o]}class co{static build(t,e,n){if("_inner"===t.name)throw new lr("the _inner name is reserved");const r=(...o)=>{const[i,s]=ao(t,[...o]);ne(t.accounts,s.accounts);const c=r.accounts(s.accounts);return void 0!==s.remainingAccounts&&c.push(...s.remainingAccounts),ur("debug-logs")&&console.log("Outgoing account metas:",c),new a({keys:c,programId:n,data:e(t.name,ee(t,...i))})};return r.accounts=e=>co.accountsArray(e,t.accounts,n,t.name),r}static accountsArray(t,e,n,r){return t?e.map(e=>{if(Qt(e)){const o=t[e.name];return co.accountsArray(o,e.accounts,n,r).flat()}let o;try{o=re(t[e.name])}catch(s){throw new Error(`Wrong input type for account "${e.name}" in the instruction accounts object${void 0!==r?' for instruction "'+r+'"':""}. Expected PublicKey or string.`)}const i=e.optional&&o.equals(n);return{pubkey:o,isWritable:Boolean(e.writable&&!i),isSigner:Boolean(e.signer&&!i)}}).flat():[]}}class uo{static build(t,e){return(...n)=>{var r,o,i;const[,s]=ao(t,[...n]),a=new c;if(s.preInstructions&&s.instructions)throw new Error("instructions is deprecated, use preInstructions");return null===(r=s.preInstructions)||void 0===r||r.forEach(t=>a.add(t)),null===(o=s.instructions)||void 0===o||o.forEach(t=>a.add(t)),a.add(e(...n)),null===(i=s.postInstructions)||void 0===i||i.forEach(t=>a.add(t)),a}}}class lo{static build(t,e,n,r){return async(...o)=>{var i;const s=e(...o),[,a]=ao(t,[...o]);if(void 0===r.sendAndConfirm)throw new Error("This function requires 'Provider.sendAndConfirm' to be implemented.");try{return await r.sendAndConfirm(s,null!==(i=a.signers)&&void 0!==i?i:[],a.options)}catch(c){throw pr(c,n)}}}}class ho{static build(t,e,n,r){var o;return(null!==(o=t.accounts)&&void 0!==o?o:[]).reduce((o,i)=>(o[i.name]=new fo(t,i,n,r,e),o),{})}}class fo{get size(){return this._size}get programId(){return this._programId}get provider(){return this._provider}get coder(){return this._coder}constructor(t,e,n,r,o){this._idlAccount=e,this._programId=n,this._provider=null!=r?r:Pe(),this._coder=null!=o?o:new vr(t),this._size=this._coder.accounts.size(e.name)}async fetchNullable(t,e){const{data:n}=await this.fetchNullableAndContext(t,e);return n}async fetchNullableAndContext(t,e){const n=await this.getAccountInfoAndContext(t,e),{value:r,context:o}=n;return{data:r&&0!==r.data.length?this._coder.accounts.decode(this._idlAccount.name,r.data):null,context:o}}async fetch(t,e){const{data:n}=await this.fetchNullableAndContext(t,e);if(null===n)throw new Error(`Account does not exist or has no data ${t.toString()}`);return n}async fetchAndContext(t,e){const{data:n,context:r}=await this.fetchNullableAndContext(t,e);if(null===n)throw new Error(`Account does not exist ${t.toString()}`);return{data:n,context:r}}async fetchMultiple(t,e){return(await this.fetchMultipleAndContext(t,e)).map(t=>t?t.data:null)}async fetchMultipleAndContext(t,e){return(await Oe(this._provider.connection,t.map(t=>re(t)),e)).map(t=>{if(null==t)return null;const{account:e,context:n}=t;return{data:this._coder.accounts.decode(this._idlAccount.name,e.data),context:n}})}async all(t){const e=this.coder.accounts.memcmp(this._idlAccount.name,t instanceof Buffer?t:void 0),n=[];return null!=(null==e?void 0:e.offset)&&null!=(null==e?void 0:e.bytes)&&n.push({memcmp:{offset:e.offset,bytes:e.bytes}}),null!=(null==e?void 0:e.dataSize)&&n.push({dataSize:e.dataSize}),(await this._provider.connection.getProgramAccounts(this._programId,{commitment:this._provider.connection.commitment,filters:[...n,...Array.isArray(t)?t:[]]})).map(({pubkey:t,account:e})=>({publicKey:t,account:this._coder.accounts.decode(this._idlAccount.name,e.data)}))}subscribe(t,e){const n=po.get(t.toString());if(n)return n.ee;const r=new Zt;t=re(t);const o=this._provider.connection.onAccountChange(t,t=>{const e=this._coder.accounts.decode(this._idlAccount.name,t.data);r.emit("change",e)},e);return po.set(t.toString(),{ee:r,listener:o}),r}async unsubscribe(t){let e=po.get(t.toString());e?po&&await this._provider.connection.removeAccountChangeListener(e.listener).then(()=>{po.delete(t.toString())}).catch(console.error):console.warn("Address is not subscribed")}async createInstruction(t,e){const n=this.size;if(void 0===this._provider.publicKey)throw new Error("This function requires the Provider interface implementor to have a 'publicKey' field.");return s.createAccount({fromPubkey:this._provider.publicKey,newAccountPubkey:t.publicKey,space:null!=e?e:n,lamports:await this._provider.connection.getMinimumBalanceForRentExemption(null!=e?e:n),programId:this._programId})}async getAccountInfo(t,e){return await this._provider.connection.getAccountInfo(re(t),e)}async getAccountInfoAndContext(t,e){return await this._provider.connection.getAccountInfoAndContext(re(t),e)}}const po=new Map;class _o{static build(t,e,n,r,o,i,s){return async(...a)=>{var c;const u=e(...a),[,l]=ao(t,[...a]);let d;if(void 0===r.simulate)throw new Error("This function requires 'Provider.simulate' to be implemented.");try{d=await r.simulate(u,l.signers,null===(c=l.options)||void 0===c?void 0:c.commitment)}catch(p){throw pr(p,n)}if(void 0===d)throw new Error("Unable to simulate transaction");const h=d.logs;if(!h)throw new Error("Simulated logs not found");const f=[];if(s.events){let t=new oo(i,o);for(const e of t.parseLogs(h))f.push(e)}return{events:f,raw:h}}}}function yo(t){return new wo($r(8),t=>Eo.fromBuffer(t),t=>t.toBuffer(),t)}function mo(t){return new wo($r(32),t=>new o(t),t=>t.toBuffer(),t)}function go(t,e){return new Ro(t,e)}class wo extends Tr{constructor(t,e,n,r){super(t.span,r),this.layout=t,this.decoder=e,this.encoder=n}decode(t,e){return this.decoder(this.layout.decode(t,e))}encode(t,e,n){return this.layout.encode(this.encoder(t),e,n)}getSpan(t,e){return this.layout.getSpan(t,e)}}class Ro extends Tr{constructor(t,e){super(-1,e),this.layout=t,this.discriminator=jr()}encode(t,e,n=0){return null==t?this.layout.span+this.discriminator.encode(0,e,n):(this.discriminator.encode(1,e,n),this.layout.encode(t,e,n+4)+4)}decode(t,e=0){const n=this.discriminator.decode(t,e);if(0===n)return null;if(1===n)return this.layout.decode(t,e+4);throw new Error("Invalid coption "+this.layout.property)}getSpan(t,e=0){return this.layout.getSpan(t,e+4)+4}}class Eo extends u{toBuffer(){const t=super.toArray().reverse(),e=Buffer.from(t);if(8===e.length)return e;if(e.length>=8)throw new Error("u64 too large");const n=Buffer.alloc(8);return e.copy(n),n}static fromBuffer(t){if(8!==t.length)throw new Error(`Invalid buffer length: ${t.length}`);return new Eo([...t].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}const Ao=Kr([mo("mint"),mo("owner"),yo("amount"),go(mo(),"delegate"),(()=>{const t=Fr((t=>new Ir(1,t))("discriminator"),null,"state");return t.addVariant(0,Kr([]),"uninitialized"),t.addVariant(1,Kr([]),"initialized"),t.addVariant(2,Kr([]),"frozen"),t})(),go(yo(),"isNative"),yo("delegatedAmount"),go(mo(),"closeAuthority")]);class vo{constructor(t,e,n,r,o,i,s,a){this._args=t,this._accounts=e,this._provider=n,this._programId=r,this._idlIx=o,this._idlTypes=s,this._customResolver=a,this._accountStore=new Oo(n,i,r)}args(t){this._args=t}async resolve(){this.resolveEventCpi(this._idlIx.accounts),this.resolveConst(this._idlIx.accounts);let t=0;for(;await this.resolvePdasAndRelations(this._idlIx.accounts)+await this.resolveCustom()>0;)if(t++,16===t){const t=e=>Qt(e)?e.accounts.some(t):!!(e.address||e.pda||e.relations),e=(t,n=[],r=[])=>{for(const o of t)Qt(o)?r.push(...e(o.accounts,[...n,o.name])):r.push([...n,o.name]);return r},n=this._idlIx.accounts.filter(t),r=e(n).filter(t=>!this.get(t)).map(t=>t.reduce((t,e)=>t+"."+e)).map(t=>`\`${t}\``).join(", ");throw new Error(["Reached maximum depth for account resolution.",`Unresolved accounts: ${r}`].join(" "))}}resolveOptionals(t){Object.assign(this._accounts,this.resolveOptionalsHelper(t,this._idlIx.accounts))}get(t){const e=t.reduce((t,e)=>t&&t[e],this._accounts);if(e&&e.toBase58)return e}set(t,e){let n=this._accounts;t.forEach((r,o)=>{var i;o===t.length-1&&(n[r]=e),n[r]=null!==(i=n[r])&&void 0!==i?i:{},n=n[r]})}resolveOptionalsHelper(t,e){const n={};for(const r of e){const e=r.name,o=t[e];void 0!==o&&(No(o)?Qt(r)?n[e]=this.resolveOptionalsHelper(o,r.accounts):n[e]=bo(o):null!==o?n[e]=re(o):r.optional&&(n[e]=this._programId))}return n}async resolveCustom(){if(this._customResolver){const{accounts:t,resolved:e}=await this._customResolver({args:this._args,accounts:this._accounts,provider:this._provider,programId:this._programId,idlIx:this._idlIx});return this._accounts=t,e}return 0}resolveEventCpi(t,e=[]){for(const n in t){const r=t[n];Qt(r)&&this.resolveEventCpi(r.accounts,[...e,r.name]);const i=+n+1;if(i===t.length)return;const s=t[n].name,a=t[i].name;if("eventAuthority"===s&&"program"===a){const t=[...e,s],n=[...e,a];return this.get(t)||this.set(t,o.findProgramAddressSync([Buffer.from("__event_authority")],this._programId)[0]),void(this.get(n)||this.set(n,this._programId))}}}resolveConst(t,e=[]){for(const n of t){const t=n.name;if(Qt(n))this.resolveConst(n.accounts,[...e,t]);else{const r=n;if((r.signer||r.address)&&!this.get([...e,t])){if(r.signer){if(!this._provider.publicKey)throw new Error("This function requires the `Provider` interface implementor to have a `publicKey` field.");this.set([...e,t],this._provider.publicKey)}r.address&&this.set([...e,t],re(r.address))}}}}async resolvePdasAndRelations(t,e=[]){let n=0;for(const r of t){const t=r.name;if(Qt(r))n+=await this.resolvePdasAndRelations(r.accounts,[...e,t]);else{const i=r;if((i.pda||i.relations)&&!this.get([...e,t])){n++;try{if(i.pda){const n=await Promise.all(i.pda.seeds.map(t=>this.toBuffer(t,e)));if(n.some(t=>!t))continue;const r=await this.parseProgramId(i,e),[s]=o.findProgramAddressSync(n,r);this.set([...e,t],s)}}catch{}try{if(i.relations){const n=this.get([...e,i.relations[0]]);if(n){const r=await this._accountStore.fetchAccount({publicKey:n});this.set([...e,t],r[t])}}}catch{}}}}return n}async parseProgramId(t,e=[]){var n;if(!(null===(n=t.pda)||void 0===n?void 0:n.program))return this._programId;const r=await this.toBuffer(t.pda.program,e);if(!r)throw new Error(`Program seed not resolved: ${t.name}`);return new o(r)}async toBuffer(t,e=[]){switch(t.kind){case"const":return this.toBufferConst(t);case"arg":return await this.toBufferArg(t);case"account":return await this.toBufferAccount(t,e);default:throw new Error(`Unexpected seed: ${t}`)}}toBufferConst(t){return this.toBufferValue("bytes",t.value)}async toBufferArg(t){const[e,...n]=t.path.split("."),r=this._idlIx.args.findIndex(t=>t.name===e);if(-1===r)throw new Error(`Unable to find argument for seed: ${e}`);const o=n.reduce((t,e)=>(null!=t?t:{})[e],this._args[r]);if(void 0===o)return;const i=this.getType(this._idlIx.args[r].type,n);return this.toBufferValue(i,o)}async toBufferAccount(t,e=[]){const[n,...r]=t.path.split("."),o=this.get([...e,n]);if(!o)return;if(!r.length)return this.toBufferValue("pubkey",o);if(!t.account)throw new Error(`Seed account is required in order to resolve type: ${t.path}`);let i=await this._accountStore.fetchAccount({publicKey:o,name:t.account}),s=r;for(;s.length>0;)i=i[s[0]],s=s.slice(1);if(void 0===i)return;const a=this.getType({defined:{name:t.account}},r);return this.toBufferValue(a,i)}toBufferValue(t,e){switch(t){case"u8":case"i8":return Buffer.from([e]);case"u16":case"i16":return new u(e).toArrayLike(Buffer,"le",2);case"u32":case"i32":return new u(e).toArrayLike(Buffer,"le",4);case"u64":case"i64":return new u(e).toArrayLike(Buffer,"le",8);case"u128":case"i128":return new u(e).toArrayLike(Buffer,"le",16);case"u256":case"i256":return new u(e).toArrayLike(Buffer,"le",32);case"string":case"bytes":return Buffer.from(e);case"pubkey":return e.toBuffer();default:if(null==t?void 0:t.array)return Buffer.from(e);throw new Error(`Unexpected seed type: ${t}`)}}getType(t,e=[]){var n;const r=null===(n=null==t?void 0:t.defined)||void 0===n?void 0:n.name;if(r){if("tokenAccount"===r)switch(e.at(0)){case"mint":case"owner":return"pubkey";case"amount":case"delagatedAmount":return"u64";default:throw new Error(`Unknown token account path: ${e}`)}const t=this._idlTypes.find(t=>t.name===r);if(!t)throw new Error(`Type not found: ${r}`);const[n,...o]=e,i=t.type.fields.find(t=>t.name===n);if(!i)throw new Error(`Field not found: ${n}`);return this.getType(i.type,o)}return t}}class Oo{constructor(t,e,n){this._provider=t,this._cache=new Map,this._idls={},this._idls[n.toBase58()]=e}async fetchAccount({publicKey:t,name:e}){const n=t.toBase58();if(!this._cache.has(n)){const o=await this._provider.connection.getAccountInfo(t);if(null===o)throw new Error(`Account not found: ${n}`);if("tokenAccount"===e){const t=(r=o.data,Ao.decode(r));this._cache.set(n,t)}else{const t=await this.getAccountsNs(o.owner);if(t){const e=Object.values(t)[0];if(e){const t=e.coder.accounts.decodeAny(o.data);this._cache.set(n,t)}}}}var r;return this._cache.get(n)}async getAccountsNs(t){const e=t.toBase58();if(!this._idls[e]){const n=await xo.fetchIdl(t,this._provider);if(n){const t=new xo(n,this._provider);this._idls[e]=t.account}}return this._idls[e]}}class To{static build(t,e,n,r,o,i,s,a,c,u,l){return(...d)=>new Io(d,r,o,i,s,a,t,e,n,c,u,l)}}function No(t){return"object"==typeof t&&null!==t&&!("_bn"in t)}function bo(t,e){const n={};for(const r in t){const e=t[r];if(null===e)throw new Error("Failed to resolve optionals due to IDL type mismatch with input accounts!");n[r]=No(e)?bo(e):re(e)}return n}class Io{constructor(t,e,n,r,o,i,s,a,c,u,l,d){this._args=t,this._ixFn=e,this._txFn=n,this._rpcFn=r,this._simulateFn=o,this._viewFn=i,this._accounts={},this._remainingAccounts=[],this._signers=[],this._preInstructions=[],this._postInstructions=[],this._resolveAccounts=!0,this._accountsResolver=new vo(t,this._accounts,s,a,c,u,l,d)}args(t){this._args=t,this._accountsResolver.args(t)}accounts(t){return this.accountsPartial(t)}accountsPartial(t){return this._resolveAccounts=!0,this._accountsResolver.resolveOptionals(t),this}accountsStrict(t){return this._resolveAccounts=!1,this._accountsResolver.resolveOptionals(t),this}signers(t){return this._signers=this._signers.concat(t),this}remainingAccounts(t){return this._remainingAccounts=this._remainingAccounts.concat(t),this}preInstructions(t,e=!1){return this._preInstructions=e?t.concat(this._preInstructions):this._preInstructions.concat(t),this}postInstructions(t){return this._postInstructions=this._postInstructions.concat(t),this}async pubkeys(){return this._resolveAccounts&&await this._accountsResolver.resolve(),this._accounts}async instruction(){return this._resolveAccounts&&await this._accountsResolver.resolve(),this._ixFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}async transaction(){return this._resolveAccounts&&await this._accountsResolver.resolve(),this._txFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}async simulate(t){return this._resolveAccounts&&await this._accountsResolver.resolve(),this._simulateFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:t})}async view(t){if(this._resolveAccounts&&await this._accountsResolver.resolve(),!this._viewFn)throw new Error(["Method does not support views.","The instruction should return a value, and its accounts must be read-only"].join(" "));return this._viewFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:t})}async rpc(t){return this._resolveAccounts&&await this._accountsResolver.resolve(),this._rpcFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:t})}async rpcAndKeys(t){return{signature:await this.rpc(t),pubkeys:await this.pubkeys()}}async prepare(){return{instruction:await this.instruction(),signers:this._signers,pubkeys:await this.pubkeys()}}}class Co{static build(t,e,n,r){const o=e.accounts.find(t=>t.writable),i=!!e.returns;if(o||!i)return;return async(...o)=>{let i=await n(...o);const s=`Program return: ${t} `;let a=i.raw.find(t=>t.startsWith(s));if(!a)throw new Error("View expected return log");let c=Yt(a.slice(s.length)),u=e.returns;if(!u)throw new Error("View expected return type");return mr.fieldLayout({type:u},r.types).decode(c)}}}class So{static build(t,e,n,r,o){const i={},s={},a={},c={},u={},l={},d=function(t){const e=new Map;return t.errors&&t.errors.forEach(t=>{var n;let r=null!==(n=t.msg)&&void 0!==n?n:t.name;e.set(t.code,r)}),e}(t),h=t.accounts?ho.build(t,e,n,r):{};return t.instructions.forEach(f=>{const p=co.build(f,(t,n)=>e.instruction.encode(t,n),n),_=uo.build(f,p),y=lo.build(f,_,d,r),m=_o.build(f,_,d,r,e,n,t),g=Co.build(n,f,m,t),w=To.build(r,n,f,p,_,y,m,g,h,t.types||[],null==o?void 0:o(f)),R=f.name;s[R]=p,a[R]=_,i[R]=y,c[R]=m,u[R]=w,g&&(l[R]=g)}),[i,s,a,h,c,u,l]}}class xo{get programId(){return this._programId}get idl(){return this._idl}get rawIdl(){return this._rawIdl}get coder(){return this._coder}get provider(){return this._provider}constructor(t,e=Pe(),n,r){this._idl=function(t){const e=["name","path","account","relations","generic"],n=t=>t.split(".").map(t=>A(t,{locale:!1})).join("."),r=t=>{for(const o in t){const i=t[o];e.includes(o)?t[o]=Array.isArray(i)?i.map(n):n(i):"object"==typeof i&&r(i)}},o=structuredClone(t);return r(o),o}(t),this._rawIdl=t,this._provider=e,this._programId=re(t.address),this._coder=null!=n?n:new vr(this._idl),this._events=new ro(this._programId,e,this._coder);const[o,i,s,a,c,u,l]=So.build(this._idl,this._coder,this._programId,e,r);this.rpc=o,this.instruction=i,this.transaction=s,this.account=a,this.simulate=c,this.methods=u,this.views=l}static async at(t,e){const n=re(t),r=await xo.fetchIdl(n,e);if(!r)throw new Error(`IDL not found for program: ${t.toString()}`);return new xo(r,e)}static async fetchIdl(t,e){e=null!=e?e:Pe();const n=re(t),r=await async function(t){const e=(await o.findProgramAddress([],t))[0];return await o.createWithSeed(e,"anchor:idl",t)}(n),i=await e.connection.getAccountInfo(r);if(!i)return null;let s=(a=i.data.slice(8),Jt.decode(a));var a;const c=$t(s.data);return JSON.parse((u=c,new TextDecoder("utf-8").decode(u)));var u}addEventListener(t,e,n){return this._events.addEventListener(t,e,n)}async removeEventListener(t){return await this._events.removeEventListener(t)}}new o("11111111111111111111111111111111");const ko={version:"0.1.0",name:"usdfg_smart_contract",instructions:[{name:"createChallenge",accounts:[{name:"challenge",isMut:!0,isSigner:!1},{name:"creator",isMut:!0,isSigner:!0},{name:"creatorTokenAccount",isMut:!0,isSigner:!1},{name:"escrowTokenAccount",isMut:!0,isSigner:!1},{name:"escrowWallet",isMut:!1,isSigner:!1},{name:"challengeSeed",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"priceOracle",isMut:!1,isSigner:!1},{name:"adminState",isMut:!1,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1}],args:[{name:"usdfgAmount",type:"u64"}]},{name:"acceptChallenge",accounts:[{name:"challenge",isMut:!0,isSigner:!1},{name:"challenger",isMut:!0,isSigner:!0},{name:"challengerTokenAccount",isMut:!0,isSigner:!1},{name:"escrowTokenAccount",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"adminState",isMut:!1,isSigner:!1},{name:"escrowWallet",isMut:!1,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1}],args:[]},{name:"resolveChallenge",accounts:[{name:"challenge",isMut:!0,isSigner:!1},{name:"escrowTokenAccount",isMut:!0,isSigner:!1},{name:"winnerTokenAccount",isMut:!0,isSigner:!1},{name:"escrowWallet",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"adminState",isMut:!1,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1}],args:[{name:"winner",type:"publicKey"}]}],accounts:[{name:"Challenge",type:{kind:"struct",fields:[{name:"creator",type:"publicKey"},{name:"challenger",type:{option:"publicKey"}},{name:"entryFee",type:"u64"},{name:"status",type:{defined:"ChallengeStatus"}},{name:"disputeTimer",type:"i64"},{name:"winner",type:{option:"publicKey"}},{name:"createdAt",type:"i64"},{name:"lastUpdated",type:"i64"},{name:"processing",type:"bool"}]}}],types:[{name:"ChallengeStatus",type:{kind:"enum",variants:[{name:"Open"},{name:"InProgress"},{name:"Completed"},{name:"Cancelled"},{name:"Disputed"}]}}],metadata:{address:"2KL4BKvUtDmABvuvRopkCEb33myWM1W9BGodAZ82RWDT"}};async function Do(t,e){const n={publicKey:t.publicKey,signTransaction:t.signTransaction,signAllTransactions:t.signAllTransactions||(async e=>{const n=[];for(const r of e)n.push(await t.signTransaction(r));return n})},r=new xe(e,n,{commitment:"confirmed"});return new xo(ko,d,r)}async function Mo(t,e){const[n]=o.findProgramAddressSync([l.ADMIN],d),[r]=o.findProgramAddressSync([l.PRICE_ORACLE],d),[i]=o.findProgramAddressSync([l.CHALLENGE,t.toBuffer(),e.toBuffer()],d),[s]=o.findProgramAddressSync([l.ESCROW_WALLET],d),[a]=o.findProgramAddressSync([l.ESCROW_WALLET,i.toBuffer(),_.toBuffer()],d);return{adminStatePDA:n,priceOraclePDA:r,challengePDA:i,escrowWalletPDA:s,escrowTokenAccountPDA:a}}async function Po(t,e,n){try{console.log("🚀 Creating challenge on smart contract..."),console.log("   Entry fee:",n,"USDFG");try{const n=await async function(t){try{const[e]=o.findProgramAddressSync([l.ADMIN],d);return null!==await t.getAccountInfo(e)}catch(e){return!1}}(e);n?console.log("✅ Smart contract already initialized"):(console.log("⚠️ Smart contract not initialized. Initializing now..."),await async function(t,e){try{console.log("🔧 Initializing USDFG Smart Contract...");const r={publicKey:t.publicKey,signTransaction:t.signTransaction,signAllTransactions:t.signAllTransactions||(async e=>{const n=[];for(const r of e)n.push(await t.signTransaction(r));return n})},i=new xe(e,r,{commitment:"confirmed"}),a=new xo(ko,d,i),[c]=o.findProgramAddressSync([l.ADMIN],d);console.log("📍 Admin State PDA:",c.toString());try{const t=await a.account.adminState.fetch(c);console.log("✅ Admin state already initialized!"),console.log("   Admin:",t.admin.toString())}catch(n){console.log("🔨 Initializing admin state...");const e=await a.methods.initialize().accounts({adminState:c,admin:t.publicKey,systemProgram:s.programId,rent:h}).rpc();console.log("✅ Admin state initialized! TX:",e)}const[f]=o.findProgramAddressSync([l.PRICE_ORACLE],d);console.log("📍 Price Oracle PDA:",f.toString());try{const t=await a.account.priceOracle.fetch(f);console.log("✅ Price oracle already initialized!"),console.log("   Price:",t.usdPerUsdfg.toString())}catch(n){console.log("🔨 Initializing price oracle...");const e=new u(15e7),r=await a.methods.initializePriceOracle(e).accounts({priceOracle:f,adminState:c,admin:t.publicKey,systemProgram:s.programId,rent:h}).rpc();console.log("✅ Price oracle initialized! TX:",r)}console.log("🎉 Smart contract fully initialized and ready!")}catch(r){throw console.error("❌ Error initializing smart contract:",r),r}}(t,e),console.log("✅ Smart contract initialized!"))}catch(r){throw console.error("❌ Error checking/initializing smart contract:",r),new Error("Smart contract initialization failed. Please contact support.")}const i=await Do(t,e),a=t.publicKey,c=f.generate();console.log("🔑 Challenge seed:",c.publicKey.toString());const g=await Mo(a,c.publicKey);console.log("📍 Challenge PDA:",g.challengePDA.toString());const w=await p(_,a),R=new u(y(n)),E=await i.methods.createChallenge(R).accounts({challenge:g.challengePDA,creator:a,creatorTokenAccount:w,escrowTokenAccount:g.escrowTokenAccountPDA,escrowWallet:g.escrowWalletPDA,challengeSeed:c.publicKey,systemProgram:s.programId,tokenProgram:m,rent:h,priceOracle:g.priceOraclePDA,adminState:g.adminStatePDA,mint:_}).signers([c]).rpc();return console.log("✅ Challenge created! Transaction:",E),console.log("📦 Challenge address:",g.challengePDA.toString()),g.challengePDA.toString()}catch(i){throw console.error("❌ Error creating challenge:",i),i}}export{Po as createChallenge,Mo as derivePDAs,Do as getProgram};

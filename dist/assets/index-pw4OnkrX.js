import{P as e,T as n,V as t}from"./index-CrN8pg2a.js";import{g as r}from"./vendor-CpVsKhXT.js";import"./ui-CFeYaOeB.js";var o,i={exports:{}};const a=r((o||(o=1,function(e){var n=Object.prototype.hasOwnProperty,t="~";function r(){}function o(e,n,t){this.fn=e,this.context=n,this.once=t||!1}function i(e,n,r,i,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var c=new o(r,i||e,a),s=t?t+n:n;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],c]:e._events[s].push(c):(e._events[s]=c,e._eventsCount++),e}function a(e,n){0===--e._eventsCount?e._events=new r:delete e._events[n]}function c(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(t=!1)),c.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)n.call(e,r)&&o.push(t?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},c.prototype.listeners=function(e){var n=t?t+e:e,r=this._events[n];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,a=new Array(i);o<i;o++)a[o]=r[o].fn;return a},c.prototype.listenerCount=function(e){var n=t?t+e:e,r=this._events[n];return r?r.fn?1:r.length:0},c.prototype.emit=function(e,n,r,o,i,a){var c=t?t+e:e;if(!this._events[c])return!1;var s,l,u=this._events[c],f=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),f){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,n),!0;case 3:return u.fn.call(u.context,n,r),!0;case 4:return u.fn.call(u.context,n,r,o),!0;case 5:return u.fn.call(u.context,n,r,o,i),!0;case 6:return u.fn.call(u.context,n,r,o,i,a),!0}for(l=1,s=new Array(f-1);l<f;l++)s[l-1]=arguments[l];u.fn.apply(u.context,s)}else{var d,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),f){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,n);break;case 3:u[l].fn.call(u[l].context,n,r);break;case 4:u[l].fn.call(u[l].context,n,r,o);break;default:if(!s)for(d=1,s=new Array(f-1);d<f;d++)s[d-1]=arguments[d];u[l].fn.apply(u[l].context,s)}}return!0},c.prototype.on=function(e,n,t){return i(this,e,n,t,!1)},c.prototype.once=function(e,n,t){return i(this,e,n,t,!0)},c.prototype.removeListener=function(e,n,r,o){var i=t?t+e:e;if(!this._events[i])return this;if(!n)return a(this,i),this;var c=this._events[i];if(c.fn)c.fn!==n||o&&!c.once||r&&c.context!==r||a(this,i);else{for(var s=0,l=[],u=c.length;s<u;s++)(c[s].fn!==n||o&&!c[s].once||r&&c[s].context!==r)&&l.push(c[s]);l.length?this._events[i]=1===l.length?l[0]:l:a(this,i)}return this},c.prototype.removeAllListeners=function(e){var n;return e?(n=t?t+e:e,this._events[n]&&a(this,n)):(this._events=new r,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=t,c.EventEmitter=c,e.exports=c}(i)),i.exports));var c,s,l,u,f=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),d=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return f(n,e),n}(a);const p=r(function(){if(u)return l;u=1;const e=s?c:(s=1,c=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),t=0;t<n.length;t++)n[t]=255;for(var r=0;r<e.length;r++){var o=e.charAt(r),i=o.charCodeAt(0);if(255!==n[i])throw new TypeError(o+" is ambiguous");n[i]=r}var a=e.length,c=e.charAt(0),s=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;for(var t=0,r=0,o=0;e[t]===c;)r++,t++;for(var i=(e.length-t)*s+1>>>0,l=new Uint8Array(i);e[t];){var u=e.charCodeAt(t);if(u>255)return;var f=n[u];if(255===f)return;for(var d=0,p=i-1;(0!==f||d<o)&&-1!==p;p--,d++)f+=a*l[p]>>>0,l[p]=f%256>>>0,f=f/256>>>0;if(0!==f)throw new Error("Non-zero carry");o=d,t++}for(var h=i-o;h!==i&&0===l[h];)h++;for(var v=new Uint8Array(r+(i-h)),_=r;h!==i;)v[_++]=l[h++];return v}return{encode:function(n){if(n instanceof Uint8Array||(ArrayBuffer.isView(n)?n=new Uint8Array(n.buffer,n.byteOffset,n.byteLength):Array.isArray(n)&&(n=Uint8Array.from(n))),!(n instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===n.length)return"";for(var t=0,r=0,o=0,i=n.length;o!==i&&0===n[o];)o++,t++;for(var s=(i-o)*l+1>>>0,u=new Uint8Array(s);o!==i;){for(var f=n[o],d=0,p=s-1;(0!==f||d<r)&&-1!==p;p--,d++)f+=256*u[p]>>>0,u[p]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");r=d,o++}for(var h=s-r;h!==s&&0===u[h];)h++;for(var v=c.repeat(t);h<s;++h)v+=e.charAt(u[h]);return v},decodeUnsafe:u,decode:function(e){var n=u(e);if(n)return n;throw new Error("Non-base"+a+" character")}}});return l=e("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")}());var h=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),v=function(){return v=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},v.apply(this,arguments)},_=function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(n){i(n)}}function c(e){try{s(r.throw(e))}catch(n){i(n)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,c)}s((r=r.apply(e,n||[])).next())})},y=function(e,n){var t,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=n.call(e,a)}catch(s){c=[6,s],r=0}finally{t=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},w=function(e,n){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var r,o,i=t.call(e),a=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(c){o={error:c}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return a},m=function(n){function t(t,r){var o,i=n.call(this)||this;if(i._handleMessage=function(n){if(i._injectedProvider&&n.source===window||n.origin===i._providerUrl.origin&&n.source===i._popup)if("connected"===n.data.method){var t=new e(n.data.params.publicKey);i._publicKey&&i._publicKey.equals(t)||(i._publicKey&&!i._publicKey.equals(t)&&i._handleDisconnect(),i._publicKey=t,i._autoApprove=!!n.data.params.autoApprove,i.emit("connect",i._publicKey))}else if("disconnected"===n.data.method)i._handleDisconnect();else if((n.data.result||n.data.error)&&i._responsePromises.has(n.data.id)){var r=w(i._responsePromises.get(n.data.id),2),o=r[0],a=r[1];n.data.result?o(n.data.result):a(new Error(n.data.error))}},i._handleConnect=function(){return i._handlerAdded||(i._handlerAdded=!0,window.addEventListener("message",i._handleMessage),window.addEventListener("beforeunload",i.disconnect)),i._injectedProvider?new Promise(function(e){i._sendRequest("connect",{}),e()}):(window.name="parent",i._popup=window.open(i._providerUrl.toString(),"_blank","location,resizable,width=460,height=675"),new Promise(function(e){i.once("connect",e)}))},i._handleDisconnect=function(){i._handlerAdded&&(i._handlerAdded=!1,window.removeEventListener("message",i._handleMessage),window.removeEventListener("beforeunload",i.disconnect)),i._publicKey&&(i._publicKey=null,i.emit("disconnect")),i._responsePromises.forEach(function(e,n){var t=w(e,2);t[0];var r=t[1];i._responsePromises.delete(n),r("Wallet disconnected")})},i._sendRequest=function(e,n){return _(i,void 0,void 0,function(){var t,r=this;return y(this,function(o){if("connect"!==e&&!this.connected)throw new Error("Wallet not connected");return t=this._nextRequestId,++this._nextRequestId,[2,new Promise(function(o,i){r._responsePromises.set(t,[o,i]),r._injectedProvider?r._injectedProvider.postMessage({jsonrpc:"2.0",id:t,method:e,params:v({network:r._network},n)}):(r._popup.postMessage({jsonrpc:"2.0",id:t,method:e,params:n},r._providerUrl.origin),r.autoApprove||r._popup.focus())})]})})},i.connect=function(){return i._popup&&i._popup.close(),i._handleConnect()},i.disconnect=function(){return _(i,void 0,void 0,function(){return y(this,function(e){switch(e.label){case 0:return this._injectedProvider?[4,this._sendRequest("disconnect",{})]:[3,2];case 1:e.sent(),e.label=2;case 2:return this._popup&&this._popup.close(),this._handleDisconnect(),[2]}})})},i.sign=function(n,t){return _(i,void 0,void 0,function(){var r,o,i;return y(this,function(a){switch(a.label){case 0:if(!(n instanceof Uint8Array))throw new Error("Data must be an instance of Uint8Array");return[4,this._sendRequest("sign",{data:n,display:t})];case 1:return r=a.sent(),o=p.decode(r.signature),i=new e(r.publicKey),[2,{signature:o,publicKey:i}]}})})},function(e){return"object"==typeof e&&null!==e}(o=t)&&function(e){return"function"==typeof e}(o.postMessage))i._injectedProvider=t;else{if(!function(e){return"string"==typeof e}(t))throw new Error("provider parameter must be an injected provider or a URL string.");i._providerUrl=new URL(t),i._providerUrl.hash=new URLSearchParams({origin:window.location.origin,network:r}).toString()}return i._network=r,i._publicKey=null,i._autoApprove=!1,i._popup=null,i._handlerAdded=!1,i._nextRequestId=1,i._responsePromises=new Map,i}return h(t,n),Object.defineProperty(t.prototype,"publicKey",{get:function(){return this._publicKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connected",{get:function(){return null!==this._publicKey},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"autoApprove",{get:function(){return this._autoApprove},enumerable:!1,configurable:!0}),t}(a);var b=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),g=function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(n){i(n)}}function c(e){try{s(r.throw(e))}catch(n){i(n)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,c)}s((r=r.apply(e,n||[])).next())})},A=function(e,n){var t,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=n.call(e,a)}catch(s){c=[6,s],r=0}finally{t=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},x=function(e){function n(n,t,r){var o=e.call(this)||this;return o._instance=null,o.handleMessage=function(e){},o._sendRequest=function(e,n){return g(o,void 0,void 0,function(){var t,r;return A(this,function(o){switch(o.label){case 0:return(null===(t=this._instance)||void 0===t?void 0:t.sendRequest)?[4,this._instance.sendRequest(e,n)]:[3,2];case 1:case 3:return[2,o.sent()];case 2:return(null===(r=this._instance)||void 0===r?void 0:r._sendRequest)?[4,this._instance._sendRequest(e,n)]:[3,4];case 4:throw new Error("Unsupported version of `@project-serum/sol-wallet-adapter`")}})})},o._handleConnect=function(){o.emit("connect")},o._handleDisconnect=function(){window.clearInterval(o._pollTimer),o.emit("disconnect")},o._network=t,o._provider=r,o}return b(n,e),Object.defineProperty(n.prototype,"publicKey",{get:function(){return this._instance.publicKey||null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"connected",{get:function(){return this._instance.connected||!1},enumerable:!1,configurable:!0}),n.prototype.connect=function(){return g(this,void 0,void 0,function(){var e=this;return A(this,function(n){switch(n.label){case 0:return this._instance=new m(this._provider,this._network),this._instance.on("connect",this._handleConnect),this._instance.on("disconnect",this._handleDisconnect),this._pollTimer=window.setInterval(function(){var n,t;!1!==(null===(t=null===(n=e._instance)||void 0===n?void 0:n._popup)||void 0===t?void 0:t.closed)&&e._handleDisconnect()},200),[4,this._instance.connect()];case 1:return n.sent(),[2]}})})},n.prototype.disconnect=function(){return g(this,void 0,void 0,function(){return A(this,function(e){switch(e.label){case 0:if(!this.connected)throw new Error("Wallet not connected");return this._instance.removeAllListeners("connect"),this._instance.removeAllListeners("disconnect"),[4,this._instance.disconnect()];case 1:return e.sent(),[2]}})})},n.prototype.signTransaction=function(e){return g(this,void 0,void 0,function(){var n;return A(this,function(t){switch(t.label){case 0:if(!this.connected)throw new Error("Wallet not connected");return[4,this._sendRequest("signTransactionV2",{transaction:p.encode(e)})];case 1:return n=t.sent().transaction,[2,p.decode(n)]}})})},n.prototype.signAllTransactions=function(e){return g(this,void 0,void 0,function(){return A(this,function(n){switch(n.label){case 0:if(!this.connected)throw new Error("Wallet not connected");return[4,this._sendRequest("signAllTransactionsV2",{transactions:e.map(function(e){return p.encode(e)})})];case 1:return[2,n.sent().transactions.map(function(e){return p.decode(e)})]}})})},n.prototype.signAndSendTransaction=function(e,n){return g(this,void 0,void 0,function(){return A(this,function(t){switch(t.label){case 0:if(!this.connected)throw new Error("Wallet not connected");return[4,this._sendRequest("signAndSendTransaction",{transaction:p.encode(e),options:n})];case 1:return[2,t.sent().signature]}})})},n.prototype.signMessage=function(e,n){return void 0===n&&(n="hex"),g(this,void 0,void 0,function(){var t;return A(this,function(r){switch(r.label){case 0:if(!this.connected)throw new Error("Wallet not connected");return[4,this._instance.sign(e,n)];case 1:return t=r.sent().signature,[2,Uint8Array.from(t)]}})})},n}(d);let E;const P=new Uint8Array(16);function j(){if(!E&&(E="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!E))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return E(P)}const I=[];for(let z=0;z<256;++z)I.push((z+256).toString(16).slice(1));const O={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function S(e,n,t){if(O.randomUUID&&!e)return O.randomUUID();const r=(e=e||{}).random||(e.rng||j)();return r[6]=15&r[6]|64,r[8]=63&r[8]|128,function(e,n=0){return I[e[n+0]]+I[e[n+1]]+I[e[n+2]]+I[e[n+3]]+"-"+I[e[n+4]]+I[e[n+5]]+"-"+I[e[n+6]]+I[e[n+7]]+"-"+I[e[n+8]]+I[e[n+9]]+"-"+I[e[n+10]]+I[e[n+11]]+I[e[n+12]]+I[e[n+13]]+I[e[n+14]]+I[e[n+15]]}(r)}var M=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),T=function(){return T=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},T.apply(this,arguments)},U=function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(n){i(n)}}function c(e){try{s(r.throw(e))}catch(n){i(n)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,c)}s((r=r.apply(e,n||[])).next())})},k=function(e,n){var t,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=n.call(e,a)}catch(s){c=[6,s],r=0}finally{t=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},K=function(n){function t(t,r){var o,i=this;return(i=n.call(this)||this)._publicKey=null,i._messageHandlers={},i.handleMessage=function(e){if(i._messageHandlers[e.id]){var n=i._messageHandlers[e.id],t=n.resolve,r=n.reject;delete i._messageHandlers[e.id],e.error?r(e.error):t(e.result)}},i._sendMessage=function(e){if(!i.connected)throw new Error("Wallet not connected");return new Promise(function(n,t){var r,o,a=S();i._messageHandlers[a]={resolve:n,reject:t},null===(o=null===(r=i._iframe)||void 0===r?void 0:r.contentWindow)||void 0===o||o.postMessage({channel:"solflareWalletAdapterToIframe",data:T({id:a},e)},"*")})},i._iframe=t,i._publicKey=new e(null===(o=null==r?void 0:r.toString)||void 0===o?void 0:o.call(r)),i}return M(t,n),Object.defineProperty(t.prototype,"publicKey",{get:function(){return this._publicKey||null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connected",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.connect=function(){return U(this,void 0,void 0,function(){return k(this,function(e){return[2]})})},t.prototype.disconnect=function(){return U(this,void 0,void 0,function(){return k(this,function(e){switch(e.label){case 0:return[4,this._sendMessage({method:"disconnect"})];case 1:return e.sent(),[2]}})})},t.prototype.signTransaction=function(e){var n;return U(this,void 0,void 0,function(){var t,r;return k(this,function(o){switch(o.label){case 0:if(!this.connected)throw new Error("Wallet not connected");o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._sendMessage({method:"signTransaction",params:{transaction:p.encode(e)}})];case 2:return t=o.sent(),[2,p.decode(t)];case 3:throw r=o.sent(),new Error((null===(n=null==r?void 0:r.toString)||void 0===n?void 0:n.call(r))||"Failed to sign transaction");case 4:return[2]}})})},t.prototype.signAllTransactions=function(e){var n;return U(this,void 0,void 0,function(){var t;return k(this,function(r){switch(r.label){case 0:if(!this.connected)throw new Error("Wallet not connected");r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this._sendMessage({method:"signAllTransactions",params:{transactions:e.map(function(e){return p.encode(e)})}})];case 2:return[2,r.sent().map(function(e){return p.decode(e)})];case 3:throw t=r.sent(),new Error((null===(n=null==t?void 0:t.toString)||void 0===n?void 0:n.call(t))||"Failed to sign transactions");case 4:return[2]}})})},t.prototype.signAndSendTransaction=function(e,n){var t;return U(this,void 0,void 0,function(){var r;return k(this,function(o){switch(o.label){case 0:if(!this.connected)throw new Error("Wallet not connected");o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._sendMessage({method:"signAndSendTransaction",params:{transaction:p.encode(e),options:n}})];case 2:return[2,o.sent()];case 3:throw r=o.sent(),new Error((null===(t=null==r?void 0:r.toString)||void 0===t?void 0:t.call(r))||"Failed to sign and send transaction");case 4:return[2]}})})},t.prototype.signMessage=function(e,n){var t;return void 0===n&&(n="hex"),U(this,void 0,void 0,function(){var r,o;return k(this,function(i){switch(i.label){case 0:if(!this.connected)throw new Error("Wallet not connected");i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._sendMessage({method:"signMessage",params:{data:e,display:n}})];case 2:return r=i.sent(),[2,Uint8Array.from(p.decode(r))];case 3:throw o=i.sent(),new Error((null===(t=null==o?void 0:o.toString)||void 0===t?void 0:t.call(o))||"Failed to sign message");case 4:return[2]}})})},t}(d);function R(e){return void 0===e.version}var C=function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(n,t)};return function(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),H=function(){return H=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e},H.apply(this,arguments)},W=function(e,n,t,r){return new(t||(t=Promise))(function(o,i){function a(e){try{s(r.next(e))}catch(n){i(n)}}function c(e){try{s(r.throw(e))}catch(n){i(n)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(a,c)}s((r=r.apply(e,n||[])).next())})},q=function(e,n){var t,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(t=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=n.call(e,a)}catch(s){c=[6,s],r=0}finally{t=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},L=function(e){function r(n){var t=e.call(this)||this;return t._network="mainnet-beta",t._provider=null,t._iframeParams={},t._adapterInstance=null,t._element=null,t._iframe=null,t._connectHandler=null,t._flutterHandlerInterval=null,t._handleEvent=function(e){var n,r,o,i;switch(e.type){case"connect_native_web":return t._collapseIframe(),t._adapterInstance=new x(t._iframe,t._network,(null===(n=e.data)||void 0===n?void 0:n.provider)||t._provider||"https://solflare.com/provider"),t._adapterInstance.on("connect",t._webConnected),t._adapterInstance.on("disconnect",t._webDisconnected),t._adapterInstance.connect(),void t._setPreferredAdapter("native_web");case"connect":return t._collapseIframe(),t._adapterInstance=new K(t._iframe,(null===(r=e.data)||void 0===r?void 0:r.publicKey)||""),t._adapterInstance.connect(),t._setPreferredAdapter(null===(o=e.data)||void 0===o?void 0:o.adapter),t._connectHandler&&(t._connectHandler.resolve(),t._connectHandler=null),void t.emit("connect",t.publicKey);case"disconnect":return t._connectHandler&&(t._connectHandler.reject(),t._connectHandler=null),t._disconnected(),void t.emit("disconnect");case"accountChanged":return void((null===(i=e.data)||void 0===i?void 0:i.publicKey)?(t._adapterInstance=new K(t._iframe,e.data.publicKey),t._adapterInstance.connect(),t.emit("accountChanged",t.publicKey)):t.emit("accountChanged",void 0));case"collapse":return void t._collapseIframe();default:return}},t._handleResize=function(e){"full"===e.resizeMode?"fullscreen"===e.params.mode?t._expandIframe():"hide"===e.params.mode&&t._collapseIframe():"coordinates"===e.resizeMode&&t._iframe&&(t._iframe.style.top=isFinite(e.params.top)?"".concat(e.params.top,"px"):"",t._iframe.style.bottom=isFinite(e.params.bottom)?"".concat(e.params.bottom,"px"):"",t._iframe.style.left=isFinite(e.params.left)?"".concat(e.params.left,"px"):"",t._iframe.style.right=isFinite(e.params.right)?"".concat(e.params.right,"px"):"",t._iframe.style.width=isFinite(e.params.width)?"".concat(e.params.width,"px"):e.params.width,t._iframe.style.height=isFinite(e.params.height)?"".concat(e.params.height,"px"):e.params.height)},t._handleMessage=function(e){var n;if("solflareIframeToWalletAdapter"===(null===(n=e.data)||void 0===n?void 0:n.channel)){var r=e.data.data||{};"event"===r.type?t._handleEvent(r.event):"resize"===r.type?t._handleResize(r):"response"===r.type&&t._adapterInstance&&t._adapterInstance.handleMessage(r)}},t._removeElement=function(){null!==t._flutterHandlerInterval&&(clearInterval(t._flutterHandlerInterval),t._flutterHandlerInterval=null),t._element&&(t._element.remove(),t._element=null)},t._removeDanglingElements=function(){var e,n,t=document.getElementsByClassName("solflare-wallet-adapter-iframe");try{for(var r=function(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),o=r.next();!o.done;o=r.next()){var i=o.value;i.parentElement&&i.remove()}}catch(a){e={error:a}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t._injectElement=function(){t._removeElement(),t._removeDanglingElements();var e=H(H({},t._iframeParams),{cluster:t._network||"mainnet-beta",origin:window.location.origin||"",title:document.title||"",version:1,sdkVersion:"1.4.2"}),n=t._getPreferredAdapter();n&&(e.adapter=n),t._provider&&(e.provider=t._provider);var o=Object.keys(e).map(function(n){return"".concat(n,"=").concat(encodeURIComponent(e[n]))}).join("&"),i="".concat(r.IFRAME_URL,"?").concat(o);t._element=document.createElement("div"),t._element.className="solflare-wallet-adapter-iframe",t._element.innerHTML="\n      <iframe src='".concat(i,"' referrerPolicy='strict-origin-when-cross-origin' style='position: fixed; top: 0; bottom: 0; left: 0; right: 0; width: 100%; height: 100%; border: none; border-radius: 0; z-index: 99999; color-scheme: auto;' allowtransparency='true'></iframe>\n    "),document.body.appendChild(t._element),t._iframe=t._element.querySelector("iframe"),window.fromFlutter=t._handleMobileMessage,t._flutterHandlerInterval=setInterval(function(){window.fromFlutter=t._handleMobileMessage},100),window.addEventListener("message",t._handleMessage,!1)},t._collapseIframe=function(){t._iframe&&(t._iframe.style.top="",t._iframe.style.right="",t._iframe.style.height="2px",t._iframe.style.width="2px")},t._expandIframe=function(){t._iframe&&(t._iframe.style.top="0px",t._iframe.style.bottom="0px",t._iframe.style.left="0px",t._iframe.style.right="0px",t._iframe.style.width="100%",t._iframe.style.height="100%")},t._getPreferredAdapter=function(){return localStorage&&localStorage.getItem("solflarePreferredWalletAdapter")||null},t._setPreferredAdapter=function(e){localStorage&&e&&localStorage.setItem("solflarePreferredWalletAdapter",e)},t._clearPreferredAdapter=function(){localStorage&&localStorage.removeItem("solflarePreferredWalletAdapter")},t._webConnected=function(){t._connectHandler&&(t._connectHandler.resolve(),t._connectHandler=null),t.emit("connect",t.publicKey)},t._webDisconnected=function(){t._connectHandler&&(t._connectHandler.reject(),t._connectHandler=null),t._disconnected(),t.emit("disconnect")},t._disconnected=function(){window.removeEventListener("message",t._handleMessage,!1),t._removeElement(),t._clearPreferredAdapter(),t._adapterInstance=null},t._handleMobileMessage=function(e){var n,r;null===(r=null===(n=t._iframe)||void 0===n?void 0:n.contentWindow)||void 0===r||r.postMessage({channel:"solflareMobileToIframe",data:e},"*")},(null==n?void 0:n.network)&&(t._network=null==n?void 0:n.network),(null==n?void 0:n.provider)&&(t._provider=null==n?void 0:n.provider),(null==n?void 0:n.params)&&(t._iframeParams=H({},null==n?void 0:n.params)),t}return C(r,e),Object.defineProperty(r.prototype,"publicKey",{get:function(){var e;return(null===(e=this._adapterInstance)||void 0===e?void 0:e.publicKey)||null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isConnected",{get:function(){var e;return!!(null===(e=this._adapterInstance)||void 0===e?void 0:e.connected)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"connected",{get:function(){return this.isConnected},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"autoApprove",{get:function(){return!1},enumerable:!1,configurable:!0}),r.prototype.connect=function(){return W(this,void 0,void 0,function(){var e=this;return q(this,function(n){switch(n.label){case 0:return this.connected?[2]:(this._injectElement(),[4,new Promise(function(n,t){e._connectHandler={resolve:n,reject:t}})]);case 1:return n.sent(),[2]}})})},r.prototype.disconnect=function(){return W(this,void 0,void 0,function(){return q(this,function(e){switch(e.label){case 0:return this._adapterInstance?[4,this._adapterInstance.disconnect()]:[2];case 1:return e.sent(),this._disconnected(),this.emit("disconnect"),[2]}})})},r.prototype.signTransaction=function(e){return W(this,void 0,void 0,function(){var r,o;return q(this,function(i){switch(i.label){case 0:if(!this.connected)throw new Error("Wallet not connected");return r=R(e)?Uint8Array.from(e.serialize({verifySignatures:!1,requireAllSignatures:!1})):e.serialize(),[4,this._adapterInstance.signTransaction(r)];case 1:return o=i.sent(),[2,R(e)?n.from(o):t.deserialize(o)]}})})},r.prototype.signAllTransactions=function(e){return W(this,void 0,void 0,function(){var r,o;return q(this,function(i){switch(i.label){case 0:if(!this.connected)throw new Error("Wallet not connected");return r=e.map(function(e){return R(e)?Uint8Array.from(e.serialize({verifySignatures:!1,requireAllSignatures:!1})):e.serialize()}),[4,this._adapterInstance.signAllTransactions(r)];case 1:if((o=i.sent()).length!==e.length)throw new Error("Failed to sign all transactions");return[2,o.map(function(r,o){return R(e[o])?n.from(r):t.deserialize(r)})]}})})},r.prototype.signAndSendTransaction=function(e,n){return W(this,void 0,void 0,function(){var t;return q(this,function(r){switch(r.label){case 0:if(!this.connected)throw new Error("Wallet not connected");return t=R(e)?e.serialize({verifySignatures:!1,requireAllSignatures:!1}):e.serialize(),[4,this._adapterInstance.signAndSendTransaction(t,n)];case 1:return[2,r.sent()]}})})},r.prototype.signMessage=function(e,n){return void 0===n&&(n="utf8"),W(this,void 0,void 0,function(){return q(this,function(t){switch(t.label){case 0:if(!this.connected)throw new Error("Wallet not connected");return[4,this._adapterInstance.signMessage(e,n)];case 1:return[2,t.sent()]}})})},r.prototype.sign=function(e,n){return void 0===n&&(n="utf8"),W(this,void 0,void 0,function(){return q(this,function(t){switch(t.label){case 0:return[4,this.signMessage(e,n)];case 1:return[2,t.sent()]}})})},r.prototype.detectWallet=function(e){var n;return void 0===e&&(e=10),W(this,void 0,void 0,function(){return q(this,function(t){return window.SolflareApp||(null===(n=window.solflare)||void 0===n?void 0:n.isSolflare)?[2,!0]:[2,new Promise(function(n){var t,r;t=setInterval(function(){var e;(window.SolflareApp||(null===(e=window.solflare)||void 0===e?void 0:e.isSolflare))&&(clearInterval(t),clearTimeout(r),n(!0))},500),r=setTimeout(function(){clearInterval(t),n(!1)},1e3*e)})]})})},r.IFRAME_URL="https://connect.solflare.com/",r}(a);export{L as default};
